[2024-11-13 08:19:18,105][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_w2v2_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-13 08:19:18,105][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-13 08:19:18,105][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'w2v2', 'encoder_ds_rate': 2, 'encoder_path': 'vitouphy/wav2vec2-xls-r-300m-timit-phoneme', 'encoder_dim': 1024, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-13 08:19:19,050][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-13 08:19:19,051][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-13 08:19:19,053][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-13 08:19:19,054][slam_llm.utils.train_utils][INFO] - --> w2v2 has 0.0 Million params

[2024-11-13 08:19:24,885][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-13 08:19:24,886][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-13 08:19:24,888][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-13 08:19:25,154][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-13 08:19:25,155][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-13 08:19:25,263][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-13 08:19:25,264][slam_llm.utils.train_utils][INFO] - --> linear has 14.68416 Million params

[2024-11-13 08:19:25,264][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_w2v2_llama32_1b_linear_peft/asr_epoch_4_step_137_loss_1.82888925075531/model.pt
[2024-11-13 08:19:25,362][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-13 08:19:25,366][slam_llm.utils.train_utils][INFO] - --> asr has 20.320256 Million params

[2024-11-13 08:19:27,650][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'raw', 'mel_size': 80, 'normalize': True}
[2024-11-13 08:19:28,752][root][INFO] - --> Training Set Length = 652
[2024-11-13 08:19:28,753][root][INFO] - =====================================
[2024-11-13 08:19:29,997][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:19:30,975][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:19:31,413][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:19:31,841][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:19:37,522][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:19:43,321][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:19:50,277][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:19:56,293][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:02,076][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:07,914][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:13,975][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:19,950][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:26,063][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:32,311][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:38,324][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:38,756][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:44,537][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:50,379][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:20:56,013][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:01,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:02,717][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:03,332][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:04,146][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:09,793][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:15,514][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:21,266][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:26,916][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:32,503][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:38,180][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:39,051][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:39,497][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:40,283][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:45,902][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:51,542][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:52,321][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:21:58,231][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:03,913][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:04,355][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:05,000][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:10,775][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:16,419][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:16,842][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:22,701][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:23,128][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:28,751][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:29,440][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:29,932][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:36,218][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:42,119][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:48,171][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:54,605][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:55,370][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:55,805][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:56,438][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:22:56,891][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:02,780][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:08,569][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:14,514][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:20,698][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:26,669][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:27,121][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:33,061][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:38,891][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:44,883][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:50,983][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:23:57,254][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:02,922][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:03,541][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:03,981][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:09,660][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:15,273][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:21,212][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:27,548][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:33,700][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:34,124][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:39,745][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:45,397][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:51,856][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:24:58,040][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:04,505][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:10,609][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:17,030][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:22,903][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:23,352][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:23,778][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:29,408][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:35,026][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:35,467][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:35,913][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:41,906][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:49,166][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:25:55,415][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:01,793][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:09,121][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:15,128][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:20,891][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:26,586][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:32,231][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:38,145][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:44,393][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:51,156][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:51,554][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:52,004][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:52,429][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:52,856][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:53,289][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:59,124][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:59,526][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:26:59,953][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:00,709][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:01,148][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:01,836][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:07,612][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:13,343][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:19,112][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:24,804][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:30,603][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:36,187][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:41,889][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:47,496][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:53,191][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:27:58,766][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:04,363][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:10,004][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:15,755][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:21,511][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:22,160][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:22,586][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:23,226][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:28,747][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:34,350][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:34,778][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:40,514][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:41,391][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:41,831][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:47,889][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:53,472][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:28:59,137][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:04,976][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:10,814][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:11,248][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:16,927][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:17,553][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:23,407][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:24,281][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:25,076][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:30,746][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:36,483][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:37,130][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:37,828][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:43,575][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:49,530][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:29:55,544][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:30:03,174][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:30:09,246][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:30:15,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:30:16,359][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:30:16,789][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:30:17,239][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:30:23,149][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:30:29,005][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:30:29,741][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 08:30:36,938][slam_llm.models.slam_model][INFO] - modality encoder
