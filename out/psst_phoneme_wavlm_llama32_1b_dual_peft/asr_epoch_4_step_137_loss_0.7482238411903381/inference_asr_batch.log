[2024-11-13 07:20:31,388][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-13 07:20:31,389][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-13 07:20:31,389][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'wavlm', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/WavLM-Large.pt', 'encoder_dim': 1024, 'encoder_projector': 'dual', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': 'w2v2', 'encoder2_dim': 1024, 'encoder2_path': 'vitouphy/wav2vec2-xls-r-300m-timit-phoneme'}
[2024-11-13 07:20:32,796][slam_llm.models.wavlm.WavLM][INFO] - WavLM Config: {'extractor_mode': 'layer_norm', 'encoder_layers': 24, 'encoder_embed_dim': 1024, 'encoder_ffn_embed_dim': 4096, 'encoder_attention_heads': 16, 'activation_fn': 'gelu', 'layer_norm_first': True, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'feature_grad_mult': 1.0, 'normalize': True, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.0, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.0, 'mask_length': 10, 'mask_prob': 0.8, 'mask_selection': 'static', 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 10, 'mask_channel_prob': 0.0, 'mask_channel_selection': 'static', 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'relative_position_embedding': True, 'num_buckets': 320, 'max_distance': 800, 'gru_rel_pos': True}
[2024-11-13 07:20:38,404][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-13 07:20:38,406][slam_llm.utils.train_utils][INFO] - --> wavlm has 315.45312 Million params

[2024-11-13 07:20:38,408][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-13 07:20:38,409][slam_llm.utils.train_utils][INFO] - --> wavlm has 0.0 Million params

[2024-11-13 07:20:38,843][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-13 07:20:38,845][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-13 07:20:38,845][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-13 07:20:38,846][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-13 07:20:44,122][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-13 07:20:44,123][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-13 07:20:44,124][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-13 07:20:44,401][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-13 07:20:44,403][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-13 07:20:44,588][slam_llm.utils.train_utils][INFO] - --> Module dual
[2024-11-13 07:20:44,590][slam_llm.utils.train_utils][INFO] - --> dual has 25.16992 Million params

[2024-11-13 07:20:44,590][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft/asr_epoch_4_step_137_loss_0.7482238411903381/model.pt
[2024-11-13 07:20:44,906][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-13 07:20:44,911][slam_llm.utils.train_utils][INFO] - --> asr has 346.244736 Million params

[2024-11-13 07:20:47,820][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'raw', 'mel_size': 80, 'normalize': True}
[2024-11-13 07:20:48,929][root][INFO] - --> Training Set Length = 652
[2024-11-13 07:20:48,930][root][INFO] - =====================================
[2024-11-13 07:20:50,336][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:20:51,285][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:20:51,858][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:20:52,440][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:20:58,071][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:04,279][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:11,233][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:17,094][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:17,829][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:23,673][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:29,533][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:35,591][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:41,959][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:48,149][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:54,093][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:21:54,594][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:00,390][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:06,291][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:11,915][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:12,745][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:13,643][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:14,155][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:14,682][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:15,458][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:16,367][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:22,058][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:22,888][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:23,528][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:29,149][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:29,714][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:30,235][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:30,857][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:31,444][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:32,014][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:32,844][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:33,719][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:34,648][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:35,103][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:35,790][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:41,505][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:42,374][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:43,033][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:43,973][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:44,498][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:45,367][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:45,916][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:46,687][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:53,006][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:22:58,854][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:05,056][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:06,863][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:07,435][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:08,016][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:08,580][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:14,327][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:15,704][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:21,623][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:22,750][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:28,903][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:30,031][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:30,705][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:32,315][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:38,197][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:44,078][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:50,070][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:23:56,274][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:01,977][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:02,410][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:03,022][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:08,749][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:14,429][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:15,669][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:17,552][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:23,511][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:23,988][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:29,738][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:30,940][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:37,395][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:39,064][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:45,536][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:51,758][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:58,229][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:24:59,420][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:00,040][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:05,742][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:11,370][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:16,992][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:17,546][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:18,144][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:24,519][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:31,884][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:38,210][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:45,002][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:52,484][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:53,880][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:25:55,408][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:01,106][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:02,132][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:08,209][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:14,864][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:21,631][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:22,120][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:22,632][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:23,136][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:23,624][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:24,254][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:25,822][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:26,256][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:26,754][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:27,268][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:27,837][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:28,473][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:34,261][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:40,001][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:45,805][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:51,570][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:57,376][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:58,024][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:58,699][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:26:59,363][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:00,005][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:00,621][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:06,355][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:07,239][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:13,144][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:18,959][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:24,622][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:25,082][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:25,616][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:31,198][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:31,776][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:32,471][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:33,261][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:33,772][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:34,473][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:35,890][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:41,658][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:42,549][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:48,259][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:49,492][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:49,995][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:50,739][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:51,370][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:57,064][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:57,648][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:58,384][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:59,284][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:27:59,989][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:00,548][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:01,489][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:02,333][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:08,262][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:14,909][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:22,485][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:28,549][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:34,870][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:35,359][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:35,825][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:36,393][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:37,329][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:38,417][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:39,613][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 07:28:46,815][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:00,600][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-20 23:41:00,601][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-20 23:41:00,601][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'wavlm', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/WavLM-Large.pt', 'encoder_dim': 1024, 'encoder_projector': 'dual', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': 'w2v2', 'encoder2_dim': 1024, 'encoder2_path': 'vitouphy/wav2vec2-xls-r-300m-timit-phoneme'}
[2024-11-20 23:41:02,156][slam_llm.models.wavlm.WavLM][INFO] - WavLM Config: {'extractor_mode': 'layer_norm', 'encoder_layers': 24, 'encoder_embed_dim': 1024, 'encoder_ffn_embed_dim': 4096, 'encoder_attention_heads': 16, 'activation_fn': 'gelu', 'layer_norm_first': True, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'feature_grad_mult': 1.0, 'normalize': True, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.0, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.0, 'mask_length': 10, 'mask_prob': 0.8, 'mask_selection': 'static', 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 10, 'mask_channel_prob': 0.0, 'mask_channel_selection': 'static', 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'relative_position_embedding': True, 'num_buckets': 320, 'max_distance': 800, 'gru_rel_pos': True}
[2024-11-20 23:41:07,500][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-20 23:41:07,502][slam_llm.utils.train_utils][INFO] - --> wavlm has 315.45312 Million params

[2024-11-20 23:41:07,504][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-20 23:41:07,505][slam_llm.utils.train_utils][INFO] - --> wavlm has 0.0 Million params

[2024-11-20 23:41:09,200][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-20 23:41:09,203][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-20 23:41:09,203][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-20 23:41:09,204][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-20 23:41:14,603][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-20 23:41:14,603][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-20 23:41:14,605][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-20 23:41:14,896][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-20 23:41:14,898][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-20 23:41:15,094][slam_llm.utils.train_utils][INFO] - --> Module dual
[2024-11-20 23:41:15,094][slam_llm.utils.train_utils][INFO] - --> dual has 25.16992 Million params

[2024-11-20 23:41:15,094][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft/asr_epoch_4_step_137_loss_0.7482238411903381/model.pt
[2024-11-20 23:41:15,358][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-20 23:41:15,364][slam_llm.utils.train_utils][INFO] - --> asr has 346.244736 Million params

[2024-11-20 23:41:17,928][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'raw', 'mel_size': 80, 'normalize': True}
[2024-11-20 23:41:19,185][root][INFO] - --> Training Set Length = 652
[2024-11-20 23:41:19,185][root][INFO] - =====================================
[2024-11-20 23:41:20,613][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:21,737][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:22,343][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:22,956][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:23,830][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:25,481][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:32,822][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:34,042][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:34,792][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:41,107][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:47,655][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:41:54,230][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:00,951][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:07,588][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:13,979][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:14,494][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:20,810][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:27,153][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:33,366][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:34,243][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:35,122][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:35,669][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:36,240][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:37,093][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:38,056][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:44,360][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:45,154][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:45,861][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:51,980][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:52,603][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:53,148][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:53,804][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:54,425][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:55,030][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:55,865][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:56,765][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:57,746][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:58,488][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:42:59,229][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:05,470][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:06,389][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:07,082][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:08,056][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:08,604][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:09,489][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:10,067][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:10,861][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:17,702][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:24,133][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:30,861][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:32,746][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:33,333][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:33,922][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:34,494][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:40,614][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:42,055][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:48,345][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:49,523][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:56,140][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:57,292][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:57,958][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:43:59,659][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:05,993][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:12,382][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:18,864][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:25,502][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:26,656][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:27,106][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:27,746][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:28,787][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:29,512][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:30,768][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:32,788][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:39,291][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:39,781][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:45,952][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:47,134][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:54,108][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:44:55,808][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:02,609][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:09,375][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:16,262][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:17,456][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:18,049][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:24,164][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:30,295][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:30,973][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:31,564][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:32,184][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:33,844][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:41,659][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:48,447][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:45:55,701][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:03,421][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:04,770][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:06,359][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:12,646][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:13,751][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:15,328][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:22,358][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:29,624][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:30,203][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:30,736][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:31,267][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:31,774][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:32,486][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:34,134][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:34,602][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:35,124][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:35,666][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:36,265][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:36,929][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:43,220][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:45,533][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:46,553][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:52,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:59,180][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:46:59,862][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:00,584][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:01,302][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:01,955][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:02,547][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:03,381][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:04,312][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:11,184][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:17,526][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:23,732][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:24,220][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:24,792][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:25,427][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:26,037][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:26,747][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:27,603][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:33,779][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:34,498][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:36,017][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:36,719][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:37,574][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:43,868][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:45,155][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:45,679][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:46,471][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:47,094][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:53,387][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:54,000][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:54,724][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:55,667][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:56,413][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:56,997][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:57,640][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:58,516][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:47:59,786][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:06,950][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:14,984][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:21,577][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:28,381][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:28,890][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:29,373][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:29,972][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:30,958][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:32,071][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:33,261][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:48:40,916][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:45:28,220][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-21 02:45:28,222][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-21 02:45:28,223][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'wavlm', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/WavLM-Large.pt', 'encoder_dim': 1024, 'encoder_projector': 'dual', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': 'w2v2', 'encoder2_dim': 1024, 'encoder2_path': 'vitouphy/wav2vec2-xls-r-300m-timit-phoneme'}
[2024-11-21 02:45:29,858][slam_llm.models.wavlm.WavLM][INFO] - WavLM Config: {'extractor_mode': 'layer_norm', 'encoder_layers': 24, 'encoder_embed_dim': 1024, 'encoder_ffn_embed_dim': 4096, 'encoder_attention_heads': 16, 'activation_fn': 'gelu', 'layer_norm_first': True, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'feature_grad_mult': 1.0, 'normalize': True, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.0, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.0, 'mask_length': 10, 'mask_prob': 0.8, 'mask_selection': 'static', 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 10, 'mask_channel_prob': 0.0, 'mask_channel_selection': 'static', 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'relative_position_embedding': True, 'num_buckets': 320, 'max_distance': 800, 'gru_rel_pos': True}
[2024-11-21 02:45:35,555][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-21 02:45:35,557][slam_llm.utils.train_utils][INFO] - --> wavlm has 315.45312 Million params

[2024-11-21 02:45:35,560][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-21 02:45:35,561][slam_llm.utils.train_utils][INFO] - --> wavlm has 0.0 Million params

[2024-11-21 02:45:37,757][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-21 02:45:37,758][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-21 02:45:37,758][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-21 02:45:37,759][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-21 02:45:44,616][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 02:45:44,619][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-21 02:45:44,620][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-21 02:45:45,012][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 02:45:45,014][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-21 02:45:45,216][slam_llm.utils.train_utils][INFO] - --> Module dual
[2024-11-21 02:45:45,216][slam_llm.utils.train_utils][INFO] - --> dual has 25.16992 Million params

[2024-11-21 02:45:45,216][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft/asr_epoch_4_step_137_loss_0.7482238411903381/model.pt
[2024-11-21 02:45:45,544][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-21 02:45:45,550][slam_llm.utils.train_utils][INFO] - --> asr has 346.244736 Million params

[2024-11-21 02:45:48,776][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'raw', 'mel_size': 80, 'normalize': True}
[2024-11-21 02:45:51,069][root][INFO] - --> Training Set Length = 652
[2024-11-21 02:45:51,070][root][INFO] - =====================================
[2024-11-21 02:45:52,547][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:45:53,647][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:45:54,264][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:45:54,892][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:01,235][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:02,840][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:10,269][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:11,798][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:12,572][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:19,082][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:25,656][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:32,370][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:39,207][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:45,947][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:52,386][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:52,912][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:46:54,212][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:00,817][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:07,115][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:08,004][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:08,978][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:09,541][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:10,108][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:10,952][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:11,939][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:18,335][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:19,138][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:19,825][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:26,107][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:26,740][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:27,296][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:27,960][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:28,592][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:29,210][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:30,067][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:30,989][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:31,995][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:32,641][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:33,377][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:39,755][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:40,679][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:41,379][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:42,375][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:42,931][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:43,798][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:44,381][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:45,176][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:47,598][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:48,835][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:55,933][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:57,877][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:58,470][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:59,036][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:47:59,623][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:05,888][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:07,351][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:13,708][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:14,974][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:16,878][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:18,035][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:18,708][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:20,434][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:21,837][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:28,387][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:35,051][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:41,846][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:42,985][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:43,440][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:44,099][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:45,157][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:45,978][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:47,244][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:49,325][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:50,668][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:51,169][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:57,524][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:48:58,715][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:05,767][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:07,497][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:09,932][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:12,102][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:19,099][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:20,258][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:20,857][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:21,461][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:22,161][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:22,849][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:23,432][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:24,060][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:25,707][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:33,564][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:40,477][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:42,773][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:50,521][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:51,888][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:53,486][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:54,787][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:55,907][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:57,698][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:49:59,903][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:07,084][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:07,570][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:08,117][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:08,661][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:09,181][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:09,907][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:11,575][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:12,036][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:12,563][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:13,111][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:13,712][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:14,379][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:15,601][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:16,386][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:17,437][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:24,114][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:30,605][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:31,308][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:31,937][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:32,672][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:33,328][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:33,926][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:40,191][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:41,161][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:42,117][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:48,541][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:54,770][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:55,270][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:55,841][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:56,486][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:57,101][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:57,808][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:58,678][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:59,259][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:50:59,995][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:01,519][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:02,231][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:03,051][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:09,433][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:10,734][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:11,271][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:12,076][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:12,704][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:14,240][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:14,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:15,599][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:16,541][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:17,298][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:17,881][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:18,530][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:19,399][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:20,630][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:27,920][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:35,986][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:37,334][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:44,182][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:44,693][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:45,189][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:45,799][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:46,809][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:47,946][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:49,127][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:51:56,957][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:05:07,597][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-21 18:05:07,598][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-21 18:05:07,598][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'wavlm', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/WavLM-Large.pt', 'encoder_dim': 1024, 'encoder_projector': 'dual', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': 'w2v2', 'encoder2_dim': 1024, 'encoder2_path': 'vitouphy/wav2vec2-xls-r-300m-timit-phoneme'}
[2024-11-21 18:05:09,091][slam_llm.models.wavlm.WavLM][INFO] - WavLM Config: {'extractor_mode': 'layer_norm', 'encoder_layers': 24, 'encoder_embed_dim': 1024, 'encoder_ffn_embed_dim': 4096, 'encoder_attention_heads': 16, 'activation_fn': 'gelu', 'layer_norm_first': True, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'feature_grad_mult': 1.0, 'normalize': True, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.0, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.0, 'mask_length': 10, 'mask_prob': 0.8, 'mask_selection': 'static', 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 10, 'mask_channel_prob': 0.0, 'mask_channel_selection': 'static', 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'relative_position_embedding': True, 'num_buckets': 320, 'max_distance': 800, 'gru_rel_pos': True}
[2024-11-21 18:05:14,867][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-21 18:05:14,869][slam_llm.utils.train_utils][INFO] - --> wavlm has 315.45312 Million params

[2024-11-21 18:05:14,871][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-21 18:05:14,872][slam_llm.utils.train_utils][INFO] - --> wavlm has 0.0 Million params

[2024-11-21 18:05:15,340][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-21 18:05:15,341][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-21 18:05:15,341][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-21 18:05:15,342][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-21 18:05:20,524][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 18:05:20,525][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-21 18:05:20,526][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-21 18:05:20,804][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 18:05:20,806][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-21 18:05:21,005][slam_llm.utils.train_utils][INFO] - --> Module dual
[2024-11-21 18:05:21,006][slam_llm.utils.train_utils][INFO] - --> dual has 25.16992 Million params

[2024-11-21 18:05:21,006][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft/asr_epoch_4_step_137_loss_0.7482238411903381/model.pt
[2024-11-21 18:05:21,153][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-21 18:05:21,158][slam_llm.utils.train_utils][INFO] - --> asr has 346.244736 Million params

[2024-11-21 18:05:24,549][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'raw', 'mel_size': 80, 'normalize': True}
[2024-11-21 18:05:25,183][root][INFO] - --> Training Set Length = 652
[2024-11-21 18:05:25,184][root][INFO] - =====================================
[2024-11-21 18:05:26,493][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:05:27,575][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:05:28,162][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:05:28,764][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:05:34,609][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:05:41,112][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:05:48,229][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:05:54,336][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:05:55,068][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:01,081][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:07,207][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:13,543][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:19,953][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:26,383][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:32,572][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:33,098][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:39,163][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:45,243][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:51,122][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:52,023][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:52,938][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:53,481][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:54,017][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:54,807][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:06:55,738][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:01,638][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:02,481][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:03,131][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:09,069][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:09,653][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:10,181][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:10,828][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:11,413][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:11,993][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:12,830][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:13,710][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:14,701][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:15,180][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:15,877][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:21,825][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:22,694][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:23,432][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:24,373][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:24,937][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:25,811][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:26,363][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:27,142][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:33,622][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:39,716][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:46,155][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:47,987][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:48,553][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:49,113][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:49,732][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:55,593][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:07:56,983][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:03,125][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:04,280][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:10,561][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:11,831][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:12,504][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:14,148][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:20,196][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:26,353][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:32,494][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:38,800][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:44,784][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:45,229][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:45,846][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:51,731][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:57,625][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:08:58,872][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:00,780][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:06,960][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:07,441][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:13,368][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:14,652][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:21,280][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:22,941][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:29,577][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:36,064][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:42,700][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:43,906][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:44,526][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:50,354][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:09:56,198][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:02,040][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:02,604][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:03,250][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:09,851][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:17,319][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:23,852][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:30,890][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:38,425][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:39,853][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:41,425][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:47,303][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:48,351][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:10:54,591][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:01,369][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:08,198][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:08,693][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:09,212][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:09,731][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:10,221][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:10,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:12,461][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:12,905][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:13,470][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:13,996][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:14,578][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:15,233][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:21,172][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:27,196][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:33,243][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:39,278][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:45,335][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:46,011][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:46,695][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:47,373][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:48,033][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:48,673][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:54,635][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:11:55,537][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:01,734][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:07,813][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:13,744][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:14,225][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:14,773][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:20,689][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:21,315][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:22,053][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:22,853][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:23,375][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:24,075][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:25,512][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:31,600][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:32,522][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:38,532][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:39,814][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:40,329][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:41,093][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:41,726][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:47,735][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:48,344][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:49,108][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:50,016][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:50,743][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:51,311][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:52,270][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:53,138][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:12:59,422][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:06,395][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:14,016][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:20,345][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:26,944][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:27,442][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:27,919][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:28,509][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:29,473][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:30,584][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:31,758][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:13:39,046][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:04:43,551][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-25 20:04:43,551][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-25 20:04:43,551][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'wavlm', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/WavLM-Large.pt', 'encoder_dim': 1024, 'encoder_projector': 'dual', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': 'w2v2', 'encoder2_dim': 1024, 'encoder2_path': 'vitouphy/wav2vec2-xls-r-300m-timit-phoneme'}
[2024-11-25 20:04:45,359][slam_llm.models.wavlm.WavLM][INFO] - WavLM Config: {'extractor_mode': 'layer_norm', 'encoder_layers': 24, 'encoder_embed_dim': 1024, 'encoder_ffn_embed_dim': 4096, 'encoder_attention_heads': 16, 'activation_fn': 'gelu', 'layer_norm_first': True, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'feature_grad_mult': 1.0, 'normalize': True, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.0, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.0, 'mask_length': 10, 'mask_prob': 0.8, 'mask_selection': 'static', 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 10, 'mask_channel_prob': 0.0, 'mask_channel_selection': 'static', 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'relative_position_embedding': True, 'num_buckets': 320, 'max_distance': 800, 'gru_rel_pos': True}
[2024-11-25 20:04:50,838][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-25 20:04:50,840][slam_llm.utils.train_utils][INFO] - --> wavlm has 315.45312 Million params

[2024-11-25 20:04:50,842][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-25 20:04:50,843][slam_llm.utils.train_utils][INFO] - --> wavlm has 0.0 Million params

[2024-11-25 20:04:53,188][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-25 20:04:53,190][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-25 20:04:53,190][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-25 20:04:53,191][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-25 20:04:58,047][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 20:04:58,048][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-25 20:04:58,049][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-25 20:04:58,346][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 20:04:58,348][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-25 20:04:58,547][slam_llm.utils.train_utils][INFO] - --> Module dual
[2024-11-25 20:04:58,547][slam_llm.utils.train_utils][INFO] - --> dual has 25.16992 Million params

[2024-11-25 20:04:58,547][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft/asr_epoch_4_step_137_loss_0.7482238411903381/model.pt
[2024-11-25 20:04:58,850][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-25 20:04:58,856][slam_llm.utils.train_utils][INFO] - --> asr has 346.244736 Million params

[2024-11-25 20:05:02,221][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'raw', 'mel_size': 80, 'normalize': True}
[2024-11-25 20:05:03,171][root][INFO] - --> Training Set Length = 652
[2024-11-25 20:05:03,171][root][INFO] - =====================================
[2024-11-25 20:05:04,546][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:05,498][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:06,068][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:06,643][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:12,428][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:18,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:26,002][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:32,080][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:32,822][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:38,889][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:44,966][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:51,180][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:05:57,574][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:03,918][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:10,027][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:10,527][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:16,497][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:22,669][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:28,517][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:29,344][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:30,250][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:30,768][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:31,301][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:32,077][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:32,996][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:38,804][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:39,634][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:40,281][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:46,165][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:46,725][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:47,246][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:47,871][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:48,463][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:49,036][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:49,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:50,731][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:51,667][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:52,115][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:52,804][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:58,647][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:06:59,507][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:00,174][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:01,106][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:01,630][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:02,492][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:03,035][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:03,805][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:10,208][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:16,307][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:22,761][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:24,575][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:25,129][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:25,694][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:26,244][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:32,095][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:33,466][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:39,587][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:40,717][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:47,088][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:48,216][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:48,904][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:50,515][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:07:56,451][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:02,453][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:08,471][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:14,615][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:20,486][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:20,906][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:21,517][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:27,384][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:33,053][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:34,283][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:36,154][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:42,377][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:42,850][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:48,751][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:49,930][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:56,610][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:08:58,259][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:04,977][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:11,517][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:18,160][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:19,333][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:19,944][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:25,762][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:31,715][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:37,573][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:38,121][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:38,713][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:45,153][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:52,697][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:09:59,219][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:06,192][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:13,794][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:15,216][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:16,795][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:22,872][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:23,900][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:30,289][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:37,102][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:44,046][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:44,535][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:45,049][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:45,562][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:46,054][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:46,676][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:48,274][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:48,709][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:49,206][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:49,725][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:50,304][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:50,941][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:10:57,014][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:02,937][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:08,891][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:14,875][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:20,808][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:21,442][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:22,113][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:22,767][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:23,407][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:24,014][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:29,908][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:30,765][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:36,877][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:42,886][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:48,706][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:49,163][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:49,697][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:55,847][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:56,417][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:57,098][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:57,882][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:58,391][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:11:59,085][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:00,486][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:06,361][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:07,254][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:13,179][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:14,397][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:14,891][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:15,629][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:16,251][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:22,142][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:22,725][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:23,454][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:24,329][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:25,033][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:25,582][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:26,529][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:27,364][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:33,338][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:40,161][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:47,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:12:54,177][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:13:00,699][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:13:01,173][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:13:01,631][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:13:02,204][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:13:03,142][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:13:04,220][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:13:05,391][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:13:12,601][slam_llm.models.slam_model][INFO] - modality encoder
