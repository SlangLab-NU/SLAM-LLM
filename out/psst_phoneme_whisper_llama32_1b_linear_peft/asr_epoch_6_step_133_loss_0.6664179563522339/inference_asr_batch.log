[2024-11-13 10:15:10,667][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-13 10:15:10,667][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-13 10:15:10,667][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-13 10:15:35,173][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-13 10:15:35,176][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-13 10:15:35,178][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-13 10:15:35,179][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-13 10:15:43,588][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-13 10:15:43,591][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-13 10:15:43,592][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-13 10:15:43,716][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-13 10:15:43,718][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-13 10:15:43,867][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-13 10:15:43,867][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-13 10:15:43,868][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_6_step_133_loss_0.6664179563522339/model.pt
[2024-11-13 10:15:44,115][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-13 10:15:44,119][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-13 10:15:47,567][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-13 10:15:48,064][root][INFO] - --> Training Set Length = 652
[2024-11-13 10:15:48,065][root][INFO] - =====================================
[2024-11-13 10:15:50,433][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:15:52,062][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:15:54,099][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:15:56,145][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:15:58,367][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:00,833][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:03,788][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:06,289][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:08,547][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:16,218][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:18,709][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:21,114][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:23,660][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:26,063][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:28,839][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:30,853][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:33,068][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:40,717][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:42,907][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:45,210][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:47,726][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:49,799][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:51,820][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:54,119][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:56,645][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:16:59,392][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:01,719][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:03,884][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:06,304][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:08,576][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:10,656][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:12,882][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:14,988][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:17,097][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:19,456][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:21,731][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:24,230][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:26,308][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:28,475][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:30,782][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:33,170][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:35,414][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:37,688][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:39,742][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:41,988][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:44,124][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:46,119][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:49,003][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:51,449][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:54,237][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:57,046][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:17:59,155][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:01,238][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:03,340][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:05,404][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:08,107][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:10,528][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:12,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:15,787][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:18,232][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:20,311][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:22,997][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:25,467][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:28,306][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:36,003][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:39,288][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:41,928][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:43,870][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:45,954][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:48,362][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:50,419][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:52,695][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:55,472][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:57,828][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:18:59,886][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:01,963][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:09,657][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:17,370][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:20,195][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:23,433][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:26,328][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:29,591][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:31,802][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:33,801][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:36,104][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:38,212][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:40,327][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:42,495][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:44,493][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:46,855][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:50,107][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:53,204][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:55,990][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:19:59,299][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:01,822][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:04,584][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:12,240][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:14,961][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:18,176][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:21,167][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:28,844][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:31,174][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:33,310][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:35,362][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:37,383][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:39,631][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:42,539][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:44,623][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:46,789][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:49,093][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:51,204][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:53,283][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:55,972][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:20:58,442][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:00,921][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:03,143][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:05,733][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:07,901][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:10,038][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:12,207][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:14,348][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:16,399][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:18,588][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:20,951][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:28,630][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:31,288][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:33,508][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:35,534][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:37,619][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:39,816][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:42,038][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:44,588][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:46,894][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:49,125][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:51,262][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:53,764][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:56,122][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:21:58,341][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:00,536][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:03,287][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:05,344][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:07,535][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:09,731][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:12,483][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:14,646][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:16,906][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:19,300][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:21,523][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:23,631][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:25,824][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:28,022][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:30,582][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:32,890][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:40,693][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:48,395][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:50,955][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:52,981][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:55,038][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:57,089][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:22:59,395][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:23:01,783][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:23:03,893][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 10:23:11,563][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:13:05,398][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-13 11:13:05,398][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-13 11:13:05,398][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-13 11:13:26,328][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-13 11:13:26,331][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-13 11:13:26,333][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-13 11:13:26,334][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-13 11:13:30,450][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-13 11:13:30,450][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-13 11:13:30,451][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-13 11:13:30,571][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-13 11:13:30,572][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-13 11:13:30,712][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-13 11:13:30,712][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-13 11:13:30,712][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_6_step_133_loss_0.6664179563522339/model.pt
[2024-11-13 11:13:30,829][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-13 11:13:30,833][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-13 11:13:33,130][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-13 11:13:33,549][root][INFO] - --> Training Set Length = 652
[2024-11-13 11:13:33,550][root][INFO] - =====================================
[2024-11-13 11:13:35,842][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:13:37,458][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:13:39,472][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:13:41,539][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:13:43,773][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:13:46,259][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:13:49,288][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:13:51,871][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:13:54,218][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:01,946][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:04,467][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:06,839][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:09,389][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:11,829][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:14,681][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:16,682][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:18,895][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:26,594][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:28,776][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:31,047][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:33,652][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:35,712][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:37,732][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:40,025][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:42,551][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:45,292][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:47,629][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:49,794][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:52,207][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:54,483][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:56,563][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:14:58,704][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:00,849][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:02,932][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:05,396][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:07,682][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:10,189][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:12,265][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:14,431][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:16,736][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:19,123][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:21,370][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:23,661][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:25,749][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:27,966][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:30,120][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:32,125][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:35,019][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:37,473][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:40,265][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:43,089][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:45,197][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:47,288][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:49,397][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:51,463][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:54,163][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:56,681][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:15:59,019][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:01,928][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:04,476][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:06,647][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:09,404][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:11,962][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:14,899][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:22,553][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:25,839][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:28,483][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:30,418][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:32,500][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:34,915][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:36,970][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:39,250][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:42,027][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:44,493][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:46,531][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:48,611][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:16:56,414][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:04,195][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:06,969][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:10,195][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:13,069][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:16,330][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:18,536][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:20,529][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:22,830][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:24,937][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:27,046][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:29,215][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:31,206][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:33,568][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:36,808][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:39,893][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:42,672][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:45,977][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:48,485][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:51,253][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:17:58,982][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:01,680][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:05,014][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:07,991][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:15,766][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:18,056][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:20,193][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:22,241][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:24,266][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:26,515][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:29,431][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:31,510][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:33,670][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:35,978][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:38,087][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:40,173][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:42,858][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:45,327][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:47,797][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:50,025][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:52,612][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:54,776][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:56,910][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:18:59,079][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:01,220][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:03,271][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:05,464][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:07,826][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:15,599][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:18,231][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:20,446][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:22,471][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:24,551][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:26,735][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:28,954][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:31,498][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:33,803][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:36,023][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:38,155][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:40,655][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:43,007][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:45,230][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:47,429][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:50,178][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:52,234][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:54,432][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:56,632][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:19:59,384][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:01,550][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:03,796][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:06,180][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:08,410][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:10,519][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:12,711][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:14,907][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:17,466][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:19,770][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:27,550][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:35,238][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:37,791][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:39,814][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:41,868][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:43,920][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:46,223][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:48,612][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:50,715][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-13 11:20:58,457][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:32:45,925][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-20 23:32:45,927][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-20 23:32:45,927][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-20 23:33:12,695][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-20 23:33:12,700][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-20 23:33:12,702][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-20 23:33:12,703][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-20 23:33:18,462][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-20 23:33:18,463][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-20 23:33:18,464][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-20 23:33:18,591][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-20 23:33:18,593][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-20 23:33:18,739][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-20 23:33:18,741][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-20 23:33:18,741][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_6_step_133_loss_0.6664179563522339/model.pt
[2024-11-20 23:33:19,026][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-20 23:33:19,030][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-20 23:33:21,817][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-20 23:33:22,329][root][INFO] - --> Training Set Length = 652
[2024-11-20 23:33:22,329][root][INFO] - =====================================
[2024-11-20 23:33:24,744][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:26,788][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:28,857][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:30,913][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:33,158][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:35,617][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:38,623][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:41,193][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:43,518][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:51,871][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:54,273][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:56,697][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:33:59,266][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:01,715][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:04,441][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:06,437][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:08,664][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:16,912][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:19,105][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:21,403][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:23,616][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:25,685][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:27,687][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:30,004][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:32,600][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:35,338][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:37,690][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:39,859][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:42,316][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:44,506][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:46,568][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:48,715][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:50,819][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:52,919][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:55,309][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:34:57,610][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:00,159][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:02,224][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:04,380][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:06,694][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:09,110][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:11,272][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:13,544][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:15,569][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:17,831][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:19,911][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:21,878][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:24,881][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:27,346][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:30,217][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:33,098][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:35,200][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:37,264][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:39,360][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:41,402][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:44,027][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:46,483][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:48,851][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:52,103][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:54,610][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:56,747][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:35:59,554][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:02,000][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:05,025][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:13,345][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:16,518][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:19,052][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:21,091][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:23,132][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:25,529][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:27,573][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:29,876][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:32,636][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:35,011][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:37,050][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:39,121][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:41,652][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:50,023][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:52,875][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:56,021][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:36:59,239][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:02,686][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:04,909][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:06,882][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:09,199][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:11,293][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:13,323][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:15,437][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:17,402][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:19,807][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:23,209][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:26,427][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:29,324][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:32,864][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:35,374][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:38,237][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:46,541][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:49,263][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:52,762][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:37:55,776][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:04,025][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:06,118][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:08,291][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:10,416][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:12,551][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:14,615][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:18,075][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:20,156][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:22,291][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:24,637][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:26,740][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:28,811][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:31,567][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:34,087][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:36,610][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:38,837][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:41,344][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:43,500][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:45,618][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:47,766][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:49,881][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:51,914][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:54,096][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:56,460][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:38:58,710][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:01,409][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:03,583][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:05,583][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:07,656][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:09,837][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:12,065][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:14,635][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:16,922][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:19,149][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:21,263][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:23,865][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:26,224][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:28,428][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:30,628][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:33,239][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:35,273][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:37,466][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:39,667][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:42,499][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:44,655][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:46,917][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:49,337][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:51,540][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:53,625][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:55,808][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:39:57,995][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:00,560][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:02,891][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:11,277][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:13,662][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:16,189][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:18,196][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:20,261][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:22,304][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:24,631][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:27,051][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:29,151][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-20 23:40:34,467][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:37:05,949][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-21 02:37:05,951][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-21 02:37:05,951][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-21 02:37:32,826][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-21 02:37:32,833][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-21 02:37:32,835][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-21 02:37:32,836][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-21 02:37:38,722][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 02:37:38,723][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-21 02:37:38,724][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-21 02:37:38,858][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 02:37:38,860][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-21 02:37:38,998][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-21 02:37:38,998][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-21 02:37:38,998][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_6_step_133_loss_0.6664179563522339/model.pt
[2024-11-21 02:37:39,304][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-21 02:37:39,309][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-21 02:37:42,992][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-21 02:37:43,849][root][INFO] - --> Training Set Length = 652
[2024-11-21 02:37:43,850][root][INFO] - =====================================
[2024-11-21 02:37:46,511][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:37:48,331][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:37:50,359][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:37:52,415][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:37:54,660][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:37:57,115][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:00,236][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:02,782][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:05,093][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:13,214][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:15,624][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:18,068][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:20,672][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:23,112][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:25,817][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:27,832][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:30,062][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:38,268][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:40,450][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:42,771][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:44,969][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:47,051][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:49,068][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:51,422][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:54,238][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:56,895][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:38:59,251][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:01,423][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:03,871][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:06,070][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:08,157][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:10,302][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:12,414][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:14,527][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:16,915][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:19,206][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:21,744][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:23,831][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:26,009][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:28,335][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:30,749][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:32,924][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:35,223][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:37,279][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:39,590][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:41,667][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:43,665][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:46,323][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:48,800][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:51,803][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:54,790][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:56,905][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:39:58,983][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:01,108][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:03,179][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:05,838][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:08,274][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:10,622][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:13,748][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:16,265][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:18,412][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:21,221][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:23,762][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:26,667][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:34,793][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:37,971][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:40,489][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:42,547][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:44,603][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:47,016][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:49,074][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:51,371][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:54,151][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:56,541][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:40:58,602][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:00,693][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:03,087][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:06,126][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:08,946][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:12,093][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:15,097][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:18,221][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:20,458][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:22,460][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:24,793][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:26,914][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:28,975][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:31,124][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:33,121][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:35,519][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:38,645][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:41,953][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:44,947][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:48,330][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:50,842][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:41:53,670][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:01,767][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:04,444][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:07,784][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:10,720][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:15,060][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:17,175][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:19,351][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:21,496][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:23,645][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:25,733][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:29,142][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:31,224][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:33,375][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:35,818][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:37,934][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:40,018][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:42,811][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:45,321][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:47,827][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:50,080][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:52,590][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:54,771][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:56,926][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:42:59,115][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:01,507][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:03,567][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:05,774][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:08,162][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:10,457][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:13,295][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:15,472][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:17,502][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:19,591][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:21,801][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:24,043][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:26,609][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:28,909][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:31,154][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:33,269][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:35,868][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:38,261][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:40,500][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:42,713][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:45,382][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:47,438][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:49,650][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:51,874][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:54,710][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:56,898][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:43:59,172][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:01,588][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:03,830][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:05,947][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:08,157][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:10,366][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:12,932][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:15,262][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:23,377][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:25,794][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:28,366][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:30,396][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:32,485][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:34,544][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:36,877][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:39,300][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:41,422][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 02:44:45,992][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:56:58,877][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-21 17:56:58,877][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-21 17:56:58,877][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-21 17:57:21,730][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-21 17:57:21,732][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-21 17:57:21,734][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-21 17:57:21,735][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-21 17:57:26,006][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 17:57:26,008][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-21 17:57:26,009][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-21 17:57:26,132][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 17:57:26,134][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-21 17:57:26,273][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-21 17:57:26,273][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-21 17:57:26,274][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_6_step_133_loss_0.6664179563522339/model.pt
[2024-11-21 17:57:26,404][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-21 17:57:26,408][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-21 17:57:29,784][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-21 17:57:30,304][root][INFO] - --> Training Set Length = 652
[2024-11-21 17:57:30,304][root][INFO] - =====================================
[2024-11-21 17:57:32,525][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:57:34,175][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:57:36,195][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:57:38,208][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:57:40,441][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:57:42,910][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:57:45,802][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:57:48,302][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:57:50,495][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:57:58,260][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:00,701][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:03,073][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:05,593][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:07,941][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:10,695][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:12,653][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:14,825][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:22,460][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:24,634][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:26,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:29,347][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:31,383][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:33,358][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:35,612][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:38,125][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:40,800][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:43,087][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:45,201][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:47,606][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:49,842][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:51,849][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:53,942][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:56,035][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:58:58,087][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:00,434][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:02,643][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:05,095][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:07,127][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:09,289][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:11,523][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:13,863][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:16,070][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:18,305][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:20,314][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:22,518][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:24,613][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:26,566][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:29,405][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:31,830][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:34,609][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:37,376][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:39,449][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:41,484][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:43,590][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:45,571][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:48,238][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:50,647][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:52,915][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:55,783][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 17:59:58,190][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:00,225][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:02,900][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:05,305][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:08,104][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:15,833][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:19,124][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:21,715][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:23,612][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:25,681][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:28,052][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:30,030][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:32,276][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:35,011][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:37,324][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:39,366][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:41,381][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:49,065][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:56,716][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:00:59,481][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:02,693][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:05,505][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:08,751][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:10,948][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:12,873][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:15,135][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:17,201][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:19,266][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:21,391][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:23,341][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:25,661][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:28,869][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:31,915][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:34,661][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:37,924][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:40,388][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:43,220][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:50,879][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:53,540][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:56,745][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:01:59,690][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:07,350][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:09,631][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:11,700][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:13,712][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:15,722][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:17,957][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:20,855][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:22,862][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:25,008][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:27,287][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:29,322][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:31,368][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:34,034][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:36,447][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:38,872][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:41,086][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:43,605][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:45,726][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:47,820][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:49,973][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:52,042][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:54,050][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:56,193][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:02:58,516][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:06,225][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:08,841][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:11,022][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:12,999][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:15,035][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:17,179][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:19,356][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:21,863][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:24,187][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:26,362][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:28,463][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:30,915][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:33,316][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:35,502][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:37,635][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:40,339][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:42,348][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:44,531][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:46,691][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:49,377][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:51,499][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:53,711][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:56,052][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:03:58,225][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:00,321][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:02,450][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:04,626][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:07,115][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:09,380][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:17,223][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:24,878][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:27,394][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:29,370][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:31,378][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:33,387][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:35,683][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:37,999][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:40,064][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 18:04:47,764][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:30,246][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-25 19:56:30,246][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-25 19:56:30,246][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-25 19:56:54,068][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-25 19:56:54,070][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-25 19:56:54,072][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-25 19:56:54,073][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-25 19:56:57,803][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 19:56:57,804][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-25 19:56:57,805][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-25 19:56:57,923][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 19:56:57,925][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-25 19:56:58,065][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-25 19:56:58,065][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-25 19:56:58,065][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_6_step_133_loss_0.6664179563522339/model.pt
[2024-11-25 19:56:58,283][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-25 19:56:58,287][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-25 19:57:00,338][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-25 19:57:00,817][root][INFO] - --> Training Set Length = 652
[2024-11-25 19:57:00,817][root][INFO] - =====================================
[2024-11-25 19:57:02,982][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:04,557][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:06,562][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:08,568][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:10,751][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:13,183][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:16,095][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:18,550][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:20,769][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:28,374][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:30,815][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:33,180][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:35,683][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:38,036][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:40,759][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:42,727][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:44,899][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:52,616][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:54,753][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:56,999][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:59,466][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:01,496][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:03,468][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:05,721][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:08,198][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:10,895][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:13,178][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:15,295][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:17,670][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:19,892][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:21,924][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:24,011][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:26,076][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:28,137][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:30,443][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:32,675][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:35,118][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:37,148][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:39,277][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:41,540][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:43,880][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:46,083][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:48,313][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:50,318][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:52,524][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:54,614][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:56,568][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:59,409][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:01,804][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:04,550][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:07,315][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:09,384][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:11,417][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:13,486][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:15,496][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:18,155][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:20,527][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:22,815][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:25,689][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:28,090][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:30,126][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:32,780][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:35,201][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:37,999][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:45,639][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:48,875][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:51,463][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:53,357][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:55,397][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:57,761][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:59,770][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:02,005][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:04,745][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:07,057][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:09,068][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:11,105][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:18,751][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:26,398][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:29,156][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:32,336][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:35,164][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:38,377][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:40,545][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:42,492][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:44,743][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:46,805][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:48,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:50,984][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:52,936][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:55,249][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:58,447][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:01,497][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:04,228][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:07,477][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:09,934][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:12,654][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:20,259][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:22,920][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:26,088][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:29,024][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:36,642][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:38,914][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:41,009][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:43,008][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:44,979][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:47,175][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:50,035][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:52,063][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:54,177][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:56,431][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:58,495][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:00,528][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:03,170][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:05,586][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:08,008][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:10,179][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:12,705][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:14,819][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:16,905][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:19,018][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:21,105][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:23,108][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:25,248][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:27,557][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:35,183][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:37,789][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:39,961][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:41,930][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:43,963][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:46,099][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:48,267][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:50,769][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:53,021][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:55,188][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:57,276][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:59,720][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:02,026][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:04,198][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:06,343][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:09,041][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:11,042][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:13,184][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:15,334][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:18,042][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:20,159][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:22,357][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:24,697][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:26,865][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:28,919][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:31,064][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:33,207][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:35,711][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:37,967][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:45,700][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:53,334][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:55,835][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:57,809][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:03:59,811][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:04:01,813][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:04:04,064][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:04:06,395][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:04:08,449][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:04:16,063][slam_llm.models.slam_model][INFO] - modality encoder
