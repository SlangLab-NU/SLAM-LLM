[2024-11-21 19:14:33,097][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-21 19:14:33,097][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-21 19:14:33,097][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-21 19:14:54,198][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-21 19:14:54,200][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-21 19:14:54,202][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-21 19:14:54,203][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-21 19:14:58,228][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 19:14:58,229][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-21 19:14:58,230][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-21 19:14:58,351][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 19:14:58,353][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-21 19:14:58,495][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-21 19:14:58,495][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-21 19:14:58,495][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_10_step_554_loss_0.8507750630378723/model.pt
[2024-11-21 19:14:58,725][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-21 19:14:58,728][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-21 19:15:01,293][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-21 19:15:01,627][root][INFO] - --> Training Set Length = 652
[2024-11-21 19:15:01,628][root][INFO] - =====================================
[2024-11-21 19:15:03,865][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:05,432][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:07,445][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:09,515][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:11,759][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:14,224][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:17,467][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:20,033][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:22,198][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:24,861][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:27,257][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:29,630][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:32,132][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:39,851][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:43,077][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:45,044][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:47,296][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:54,931][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:57,103][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:15:59,307][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:16:06,946][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:16:08,977][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:16:10,980][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:23:16,964][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-21 19:23:16,964][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-21 19:23:16,964][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-21 19:23:38,165][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-21 19:23:38,167][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-21 19:23:38,169][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-21 19:23:38,170][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-21 19:23:42,963][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 19:23:42,964][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-21 19:23:42,965][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-21 19:23:43,083][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-21 19:23:43,084][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-21 19:23:43,206][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-21 19:23:43,206][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-21 19:23:43,206][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_10_step_554_loss_0.8507750630378723/model.pt
[2024-11-21 19:23:43,372][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-21 19:23:43,375][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-21 19:23:45,753][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-21 19:23:46,327][root][INFO] - --> Training Set Length = 652
[2024-11-21 19:23:46,328][root][INFO] - =====================================
[2024-11-21 19:23:48,902][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:23:51,513][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:23:53,550][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:23:55,588][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:23:57,890][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:00,365][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:03,539][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:06,124][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:08,288][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:10,949][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:13,342][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:15,713][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:18,185][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:25,854][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:29,011][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:30,980][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:33,196][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:40,870][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:43,036][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:45,233][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:52,912][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:54,974][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:56,951][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:24:59,173][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:01,873][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:04,404][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:06,685][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:08,800][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:11,208][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:13,319][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:15,423][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:17,505][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:19,626][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:21,688][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:23,890][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:26,094][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:28,574][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:30,689][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:32,867][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:35,132][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:37,447][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:39,563][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:41,908][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:43,915][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:46,122][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:48,183][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:50,137][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:52,971][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:55,399][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:25:58,173][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:00,853][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:02,946][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:04,990][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:07,159][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:09,172][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:11,695][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:14,046][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:16,223][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:19,148][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:21,579][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:29,234][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:31,880][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:34,527][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:37,347][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:40,900][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:44,053][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:46,566][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:48,456][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:50,480][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:52,680][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:54,720][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:56,931][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:26:59,703][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:02,176][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:04,236][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:06,306][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:08,431][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:16,101][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:23,751][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:26,973][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:29,917][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:37,652][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:45,275][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:47,227][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:49,289][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:51,325][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:53,386][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:55,508][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:57,487][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:27:59,786][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:03,173][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:06,162][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:08,953][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:12,789][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:15,242][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:17,990][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:20,642][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:23,173][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:25,795][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:28,763][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:36,415][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:38,474][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:40,503][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:42,623][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:44,579][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:46,618][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:49,736][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:51,719][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:53,758][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:55,848][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:28:57,914][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:00,009][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:02,460][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:04,756][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:07,289][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:09,434][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:11,838][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:19,492][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:21,584][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:23,643][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:25,782][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:27,768][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:29,974][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:32,343][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:34,497][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:37,332][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:39,396][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:41,374][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:43,469][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:45,614][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:47,676][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:49,765][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:52,005][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:54,020][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:56,087][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:29:58,567][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:00,745][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:02,892][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:05,074][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:07,654][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:09,634][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:11,801][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:13,893][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:16,570][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:18,608][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:20,786][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:23,129][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:25,337][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:27,386][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:29,536][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:31,662][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:34,200][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:36,630][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:39,932][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:42,195][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:44,654][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:46,701][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:48,979][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:50,959][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:53,251][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:55,600][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:30:57,635][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-21 19:31:05,303][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:55:10,797][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-25 19:55:10,797][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-25 19:55:10,797][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-25 19:55:33,098][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-25 19:55:33,100][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-25 19:55:33,102][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-25 19:55:33,103][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-25 19:55:37,474][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 19:55:37,475][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-25 19:55:37,476][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-25 19:55:37,597][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 19:55:37,599][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-25 19:55:37,722][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-25 19:55:37,722][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-25 19:55:37,722][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_10_step_554_loss_0.8507750630378723/model.pt
[2024-11-25 19:55:37,919][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-25 19:55:37,922][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-25 19:55:40,196][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-25 19:55:40,401][root][INFO] - --> Training Set Length = 652
[2024-11-25 19:55:40,401][root][INFO] - =====================================
[2024-11-25 19:55:42,551][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:55:44,127][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:55:46,139][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:55:48,206][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:55:50,454][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:55:52,892][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:55:56,118][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:55:58,697][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:00,861][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:03,520][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:05,920][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:08,288][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:10,737][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:18,335][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:21,492][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:23,463][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:25,690][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:33,312][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:35,478][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:37,676][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:45,311][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:47,341][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:49,347][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:51,568][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:54,268][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:56,801][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:56:59,086][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:01,196][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:03,564][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:05,709][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:07,770][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:09,862][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:11,946][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:14,040][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:16,246][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:18,451][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:20,922][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:22,987][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:25,133][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:27,423][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:29,735][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:31,823][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:34,166][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:36,170][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:38,375][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:40,441][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:42,389][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:45,198][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:47,645][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:50,421][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:53,105][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:55,167][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:57,233][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:57:59,378][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:01,411][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:03,933][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:06,275][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:08,457][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:11,388][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:13,818][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:21,442][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:24,083][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:26,728][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:29,544][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:33,043][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:36,200][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:38,734][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:40,623][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:42,626][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:44,825][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:46,834][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:49,066][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:51,821][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:54,267][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:56,326][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:58:58,384][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:00,531][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:08,175][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:15,809][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:19,025][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:21,969][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:29,615][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:37,219][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:39,165][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:41,227][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:43,260][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:45,316][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:47,431][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:49,409][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:51,696][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:55,084][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 19:59:58,075][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:00,867][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:04,697][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:07,154][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:09,878][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:12,523][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:15,084][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:17,695][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:20,637][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:28,264][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:30,327][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:32,362][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:34,453][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:36,431][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:38,470][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:41,563][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:43,540][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:45,555][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:47,645][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:49,712][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:51,801][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:54,253][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:56,510][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:00:59,078][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:01,221][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:03,627][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:11,250][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:13,311][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:15,393][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:17,507][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:19,482][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:21,658][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:24,032][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:26,208][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:29,045][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:31,106][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:33,087][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:35,178][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:37,323][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:39,387][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:41,474][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:43,675][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:45,711][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:47,751][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:50,258][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:52,378][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:54,553][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:56,732][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:01:59,281][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:01,293][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:03,417][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:05,542][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:08,222][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:10,270][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:12,444][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:14,784][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:16,987][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:19,024][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:21,171][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:23,288][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:25,830][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:28,201][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:31,500][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:33,763][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:36,198][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:38,233][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:40,490][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:42,499][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:44,762][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:47,104][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:49,144][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-25 20:02:56,779][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:33:52,581][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-26 00:33:52,582][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-26 00:33:52,582][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-26 00:34:13,050][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-26 00:34:13,052][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-26 00:34:13,054][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-26 00:34:13,056][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-26 00:34:16,916][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-26 00:34:16,916][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-26 00:34:16,917][slam_llm.models.slam_model][INFO] - setup peft...
[2024-11-26 00:34:17,034][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-26 00:34:17,036][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-26 00:34:17,175][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-26 00:34:17,175][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-26 00:34:17,175][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_10_step_554_loss_0.8507750630378723/model.pt
[2024-11-26 00:34:17,407][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-26 00:34:17,411][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-26 00:34:19,379][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-26 00:34:19,705][root][INFO] - --> Training Set Length = 652
[2024-11-26 00:34:19,706][root][INFO] - =====================================
[2024-11-26 00:34:21,807][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:23,370][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:25,419][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:27,522][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:29,801][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:32,280][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:35,532][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:38,149][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:40,354][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:43,055][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:45,487][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:47,892][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:50,383][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:34:58,002][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:01,317][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:03,298][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:05,564][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:13,198][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:15,406][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:17,642][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:25,291][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:27,363][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:29,405][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:31,663][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:34,398][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:36,974][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:39,303][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:41,458][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:43,866][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:46,053][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:48,158][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:50,291][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:52,422][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:54,557][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:56,802][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:35:59,045][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:01,561][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:03,660][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:05,848][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:08,176][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:10,527][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:12,656][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:15,039][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:17,084][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:19,324][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:21,427][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:23,418][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:26,263][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:28,753][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:31,563][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:34,284][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:36,390][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:38,489][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:40,674][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:42,750][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:45,304][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:47,681][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:49,904][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:52,863][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:36:55,329][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:02,974][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:05,647][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:08,328][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:11,184][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:14,717][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:17,909][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:20,481][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:22,417][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:24,469][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:26,704][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:28,758][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:31,033][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:33,932][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:36,400][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:38,510][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:40,612][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:42,804][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:50,494][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:37:58,163][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:01,418][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:04,399][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:12,072][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:19,706][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:21,694][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:23,792][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:25,875][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:27,973][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:30,133][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:32,152][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:34,478][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:37,897][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:40,924][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:43,759][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:47,632][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:50,130][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:52,896][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:55,571][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:38:58,170][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:00,823][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:03,801][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:11,456][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:13,561][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:15,638][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:17,764][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:19,787][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:21,870][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:24,996][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:27,013][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:29,060][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:31,197][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:33,301][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:35,434][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:37,923][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:40,223][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:42,833][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:45,024][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:47,465][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:55,114][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:57,219][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:39:59,350][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:01,508][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:03,529][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:05,744][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:08,146][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:10,357][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:13,235][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:15,341][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:17,360][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:19,492][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:21,677][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:23,781][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:25,909][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:28,153][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:30,233][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:32,321][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:34,868][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:37,028][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:39,246][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:41,467][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:44,046][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:46,096][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:48,258][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:50,423][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:53,145][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:55,224][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:57,442][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:40:59,825][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:02,075][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:04,149][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:06,336][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:08,496][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:11,076][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:13,487][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:16,827][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:19,133][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:21,602][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:23,679][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:25,983][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:28,030][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:30,332][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:32,720][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:34,801][slam_llm.models.slam_model][INFO] - modality encoder
[2024-11-26 00:41:42,455][slam_llm.models.slam_model][INFO] - modality encoder
