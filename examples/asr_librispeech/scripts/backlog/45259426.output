
/work/van-speech-nlp/jindaznb/slamenv/bin/python
Running job script...
Configuration:
Task: test
Prompt Flag: 
Config File: wavlm-mono
Epochs: 10
Batch Size: 4
Data Folder: psst_phoneme
Use PEFT: true
LLM Name: llama32_1b
Freeze Encoder: true
speech encoder name: wavlm
speech encoder path: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/WavLM-Large.pt
speech encoder2 name: 
speech encoder2 path: 
llm_path: 
use_peft: true
use_fp16: 
Final identifier: psst_phoneme_wavlm_llama32_1b_linear_peft
Latest file: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_linear_peft/asr_epoch_10_step_554_loss_1.0206900835037231/model.pt
ckpt_folder: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_linear_peft/asr_epoch_10_step_554_loss_1.0206900835037231
Resume epoch: 10
Resume step: 554
Selected lowest loss checkpoint: asr_epoch_4_step_137_loss_0.7657225131988525
Checkpoint file: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_linear_peft/asr_epoch_4_step_137_loss_0.7657225131988525/model.pt
ckpt_folder /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_linear_peft/asr_epoch_4_step_137_loss_0.7657225131988525
[2024-11-25 19:49:09][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-25 19:49:09][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-25 19:49:09][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'wavlm', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/WavLM-Large.pt', 'encoder_dim': 1024, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-25 19:49:11][slam_llm.models.wavlm.WavLM][INFO] - WavLM Config: {'extractor_mode': 'layer_norm', 'encoder_layers': 24, 'encoder_embed_dim': 1024, 'encoder_ffn_embed_dim': 4096, 'encoder_attention_heads': 16, 'activation_fn': 'gelu', 'layer_norm_first': True, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'feature_grad_mult': 1.0, 'normalize': True, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.0, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.0, 'mask_length': 10, 'mask_prob': 0.8, 'mask_selection': 'static', 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 10, 'mask_channel_prob': 0.0, 'mask_channel_selection': 'static', 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'relative_position_embedding': True, 'num_buckets': 320, 'max_distance': 800, 'gru_rel_pos': True}
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:28: UserWarning: torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.
  warnings.warn("torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.")
[2024-11-25 19:49:17][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-25 19:49:17][slam_llm.utils.train_utils][INFO] - --> wavlm has 315.45312 Million params

[2024-11-25 19:49:17][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-25 19:49:17][slam_llm.utils.train_utils][INFO] - --> wavlm has 0.0 Million params

[2024-11-25 19:49:25][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 19:49:25][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-25 19:49:25][slam_llm.models.slam_model][INFO] - setup peft...
trainable params: 5,636,096 || all params: 1,241,450,496 || trainable%: 0.4539928106807088
[2024-11-25 19:49:25][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 19:49:25][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-25 19:49:25][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-25 19:49:25][slam_llm.utils.train_utils][INFO] - --> linear has 14.68416 Million params

[2024-11-25 19:49:25][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_linear_peft/asr_epoch_4_step_137_loss_0.7657225131988525/model.pt
[2024-11-25 19:49:25][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-25 19:49:25][slam_llm.utils.train_utils][INFO] - --> asr has 20.320256 Million params

[2024-11-25 19:49:27][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'raw', 'mel_size': 80, 'normalize': True}
[2024-11-25 19:49:29][root][INFO] - --> Training Set Length = 652
[2024-11-25 19:49:29][root][INFO] - =====================================

  0%|          | 0/163 [00:00<?, ?it/s]/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
[2024-11-25 19:49:30][slam_llm.models.slam_model][INFO] - modality encoder
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.7` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.92` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(

  1%|          | 1/163 [00:02<07:56,  2.94s/it][2024-11-25 19:49:32][slam_llm.models.slam_model][INFO] - modality encoder

  1%|          | 2/163 [00:03<04:05,  1.53s/it][2024-11-25 19:49:32][slam_llm.models.slam_model][INFO] - modality encoder

  2%|▏         | 3/163 [00:04<02:51,  1.07s/it][2024-11-25 19:49:33][slam_llm.models.slam_model][INFO] - modality encoder

  2%|▏         | 4/163 [00:09<07:44,  2.92s/it][2024-11-25 19:49:39][slam_llm.models.slam_model][INFO] - modality encoder

  3%|▎         | 5/163 [00:10<05:47,  2.20s/it][2024-11-25 19:49:40][slam_llm.models.slam_model][INFO] - modality encoder

  4%|▎         | 6/163 [00:17<09:50,  3.76s/it][2024-11-25 19:49:46][slam_llm.models.slam_model][INFO] - modality encoder

  4%|▍         | 7/163 [00:23<11:47,  4.53s/it][2024-11-25 19:49:52][slam_llm.models.slam_model][INFO] - modality encoder

  5%|▍         | 8/163 [00:29<12:28,  4.83s/it][2024-11-25 19:49:58][slam_llm.models.slam_model][INFO] - modality encoder

  6%|▌         | 9/163 [00:35<13:25,  5.23s/it][2024-11-25 19:50:04][slam_llm.models.slam_model][INFO] - modality encoder

  6%|▌         | 10/163 [00:40<13:47,  5.41s/it][2024-11-25 19:50:10][slam_llm.models.slam_model][INFO] - modality encoder

  7%|▋         | 11/163 [00:46<13:50,  5.46s/it][2024-11-25 19:50:15][slam_llm.models.slam_model][INFO] - modality encoder

  7%|▋         | 12/163 [00:52<14:10,  5.63s/it][2024-11-25 19:50:21][slam_llm.models.slam_model][INFO] - modality encoder

  8%|▊         | 13/163 [00:53<10:41,  4.28s/it][2024-11-25 19:50:22][slam_llm.models.slam_model][INFO] - modality encoder

  9%|▊         | 14/163 [00:59<11:53,  4.79s/it][2024-11-25 19:50:28][slam_llm.models.slam_model][INFO] - modality encoder

  9%|▉         | 15/163 [01:00<08:37,  3.50s/it][2024-11-25 19:50:29][slam_llm.models.slam_model][INFO] - modality encoder

 10%|▉         | 16/163 [01:01<06:35,  2.69s/it][2024-11-25 19:50:30][slam_llm.models.slam_model][INFO] - modality encoder

 10%|█         | 17/163 [01:03<06:01,  2.47s/it][2024-11-25 19:50:32][slam_llm.models.slam_model][INFO] - modality encoder

 11%|█         | 18/163 [01:08<08:14,  3.41s/it][2024-11-25 19:50:37][slam_llm.models.slam_model][INFO] - modality encoder

 12%|█▏        | 19/163 [01:09<06:27,  2.69s/it][2024-11-25 19:50:38][slam_llm.models.slam_model][INFO] - modality encoder

 12%|█▏        | 20/163 [01:10<05:07,  2.15s/it][2024-11-25 19:50:39][slam_llm.models.slam_model][INFO] - modality encoder

 13%|█▎        | 21/163 [01:11<03:56,  1.67s/it][2024-11-25 19:50:40][slam_llm.models.slam_model][INFO] - modality encoder

 13%|█▎        | 22/163 [01:11<03:04,  1.31s/it][2024-11-25 19:50:40][slam_llm.models.slam_model][INFO] - modality encoder

 14%|█▍        | 23/163 [01:12<02:37,  1.13s/it][2024-11-25 19:50:41][slam_llm.models.slam_model][INFO] - modality encoder

 15%|█▍        | 24/163 [01:13<02:36,  1.12s/it][2024-11-25 19:50:42][slam_llm.models.slam_model][INFO] - modality encoder

 15%|█▌        | 25/163 [01:14<02:35,  1.13s/it][2024-11-25 19:50:43][slam_llm.models.slam_model][INFO] - modality encoder

 16%|█▌        | 26/163 [01:20<05:38,  2.47s/it][2024-11-25 19:50:49][slam_llm.models.slam_model][INFO] - modality encoder

 17%|█▋        | 27/163 [01:20<04:19,  1.91s/it][2024-11-25 19:50:49][slam_llm.models.slam_model][INFO] - modality encoder

 17%|█▋        | 28/163 [01:21<03:48,  1.69s/it][2024-11-25 19:50:51][slam_llm.models.slam_model][INFO] - modality encoder

 18%|█▊        | 29/163 [01:22<03:01,  1.35s/it][2024-11-25 19:50:51][slam_llm.models.slam_model][INFO] - modality encoder

 18%|█▊        | 30/163 [01:22<02:24,  1.09s/it][2024-11-25 19:50:52][slam_llm.models.slam_model][INFO] - modality encoder

 19%|█▉        | 31/163 [01:23<02:01,  1.08it/s][2024-11-25 19:50:52][slam_llm.models.slam_model][INFO] - modality encoder

 20%|█▉        | 32/163 [01:24<01:48,  1.21it/s][2024-11-25 19:50:53][slam_llm.models.slam_model][INFO] - modality encoder

 20%|██        | 33/163 [01:24<01:39,  1.30it/s][2024-11-25 19:50:53][slam_llm.models.slam_model][INFO] - modality encoder

 21%|██        | 34/163 [01:25<01:37,  1.33it/s][2024-11-25 19:50:54][slam_llm.models.slam_model][INFO] - modality encoder

 21%|██▏       | 35/163 [01:26<01:42,  1.24it/s][2024-11-25 19:50:55][slam_llm.models.slam_model][INFO] - modality encoder

 22%|██▏       | 36/163 [01:27<01:48,  1.17it/s][2024-11-25 19:50:56][slam_llm.models.slam_model][INFO] - modality encoder

 23%|██▎       | 37/163 [01:27<01:30,  1.39it/s][2024-11-25 19:50:56][slam_llm.models.slam_model][INFO] - modality encoder

 23%|██▎       | 38/163 [01:28<01:27,  1.43it/s][2024-11-25 19:50:57][slam_llm.models.slam_model][INFO] - modality encoder

 24%|██▍       | 39/163 [01:34<04:40,  2.26s/it][2024-11-25 19:51:03][slam_llm.models.slam_model][INFO] - modality encoder

 25%|██▍       | 40/163 [01:35<03:45,  1.83s/it][2024-11-25 19:51:04][slam_llm.models.slam_model][INFO] - modality encoder

 25%|██▌       | 41/163 [01:35<02:56,  1.44s/it][2024-11-25 19:51:04][slam_llm.models.slam_model][INFO] - modality encoder

 26%|██▌       | 42/163 [01:36<02:37,  1.30s/it][2024-11-25 19:51:05][slam_llm.models.slam_model][INFO] - modality encoder

 26%|██▋       | 43/163 [01:37<02:06,  1.06s/it][2024-11-25 19:51:06][slam_llm.models.slam_model][INFO] - modality encoder

 27%|██▋       | 44/163 [01:37<01:56,  1.02it/s][2024-11-25 19:51:07][slam_llm.models.slam_model][INFO] - modality encoder

 28%|██▊       | 45/163 [01:38<01:41,  1.16it/s][2024-11-25 19:51:07][slam_llm.models.slam_model][INFO] - modality encoder

 28%|██▊       | 46/163 [01:38<01:28,  1.33it/s][2024-11-25 19:51:08][slam_llm.models.slam_model][INFO] - modality encoder

 29%|██▉       | 47/163 [01:45<04:47,  2.48s/it][2024-11-25 19:51:14][slam_llm.models.slam_model][INFO] - modality encoder

 29%|██▉       | 48/163 [01:46<03:53,  2.03s/it][2024-11-25 19:51:15][slam_llm.models.slam_model][INFO] - modality encoder

 30%|███       | 49/163 [01:48<03:39,  1.93s/it][2024-11-25 19:51:17][slam_llm.models.slam_model][INFO] - modality encoder

 31%|███       | 50/163 [01:54<06:16,  3.33s/it][2024-11-25 19:51:23][slam_llm.models.slam_model][INFO] - modality encoder

 31%|███▏      | 51/163 [01:55<04:38,  2.49s/it][2024-11-25 19:51:24][slam_llm.models.slam_model][INFO] - modality encoder

 32%|███▏      | 52/163 [01:55<03:32,  1.91s/it][2024-11-25 19:51:25][slam_llm.models.slam_model][INFO] - modality encoder

 33%|███▎      | 53/163 [01:56<02:45,  1.51s/it][2024-11-25 19:51:25][slam_llm.models.slam_model][INFO] - modality encoder

 33%|███▎      | 54/163 [01:56<02:11,  1.21s/it][2024-11-25 19:51:26][slam_llm.models.slam_model][INFO] - modality encoder

 34%|███▎      | 55/163 [02:02<04:40,  2.60s/it][2024-11-25 19:51:31][slam_llm.models.slam_model][INFO] - modality encoder

 34%|███▍      | 56/163 [02:08<06:19,  3.55s/it][2024-11-25 19:51:37][slam_llm.models.slam_model][INFO] - modality encoder

 35%|███▍      | 57/163 [02:14<07:34,  4.29s/it][2024-11-25 19:51:43][slam_llm.models.slam_model][INFO] - modality encoder

 36%|███▌      | 58/163 [02:16<06:03,  3.46s/it][2024-11-25 19:51:45][slam_llm.models.slam_model][INFO] - modality encoder

 36%|███▌      | 59/163 [02:22<07:21,  4.25s/it][2024-11-25 19:51:51][slam_llm.models.slam_model][INFO] - modality encoder

 37%|███▋      | 60/163 [02:22<05:22,  3.13s/it][2024-11-25 19:51:51][slam_llm.models.slam_model][INFO] - modality encoder

 37%|███▋      | 61/163 [02:24<04:28,  2.63s/it][2024-11-25 19:51:53][slam_llm.models.slam_model][INFO] - modality encoder

 38%|███▊      | 62/163 [02:25<03:39,  2.17s/it][2024-11-25 19:51:54][slam_llm.models.slam_model][INFO] - modality encoder

 39%|███▊      | 63/163 [02:31<05:26,  3.27s/it][2024-11-25 19:52:00][slam_llm.models.slam_model][INFO] - modality encoder

 39%|███▉      | 64/163 [02:36<06:35,  3.99s/it][2024-11-25 19:52:05][slam_llm.models.slam_model][INFO] - modality encoder

 40%|███▉      | 65/163 [02:42<07:38,  4.68s/it][2024-11-25 19:52:12][slam_llm.models.slam_model][INFO] - modality encoder

 40%|████      | 66/163 [02:43<05:42,  3.53s/it][2024-11-25 19:52:13][slam_llm.models.slam_model][INFO] - modality encoder

 41%|████      | 67/163 [02:44<04:10,  2.61s/it][2024-11-25 19:52:13][slam_llm.models.slam_model][INFO] - modality encoder

 42%|████▏     | 68/163 [02:44<03:06,  1.97s/it][2024-11-25 19:52:13][slam_llm.models.slam_model][INFO] - modality encoder

 42%|████▏     | 69/163 [02:45<02:33,  1.63s/it][2024-11-25 19:52:14][slam_llm.models.slam_model][INFO] - modality encoder

 43%|████▎     | 70/163 [02:46<02:01,  1.30s/it][2024-11-25 19:52:15][slam_llm.models.slam_model][INFO] - modality encoder

 44%|████▎     | 71/163 [02:46<01:46,  1.16s/it][2024-11-25 19:52:16][slam_llm.models.slam_model][INFO] - modality encoder

 44%|████▍     | 72/163 [02:53<04:09,  2.74s/it][2024-11-25 19:52:22][slam_llm.models.slam_model][INFO] - modality encoder

 45%|████▍     | 73/163 [02:54<03:29,  2.33s/it][2024-11-25 19:52:23][slam_llm.models.slam_model][INFO] - modality encoder

 45%|████▌     | 74/163 [02:55<02:35,  1.75s/it][2024-11-25 19:52:24][slam_llm.models.slam_model][INFO] - modality encoder

 46%|████▌     | 75/163 [03:00<04:16,  2.91s/it][2024-11-25 19:52:30][slam_llm.models.slam_model][INFO] - modality encoder

 47%|████▋     | 76/163 [03:01<03:22,  2.33s/it][2024-11-25 19:52:31][slam_llm.models.slam_model][INFO] - modality encoder

 47%|████▋     | 77/163 [03:08<05:06,  3.56s/it][2024-11-25 19:52:37][slam_llm.models.slam_model][INFO] - modality encoder

 48%|████▊     | 78/163 [03:09<04:11,  2.96s/it][2024-11-25 19:52:39][slam_llm.models.slam_model][INFO] - modality encoder

 48%|████▊     | 79/163 [03:16<05:35,  4.00s/it][2024-11-25 19:52:45][slam_llm.models.slam_model][INFO] - modality encoder

 49%|████▉     | 80/163 [03:22<06:27,  4.67s/it][2024-11-25 19:52:51][slam_llm.models.slam_model][INFO] - modality encoder

 50%|████▉     | 81/163 [03:28<07:01,  5.14s/it][2024-11-25 19:52:57][slam_llm.models.slam_model][INFO] - modality encoder

 50%|█████     | 82/163 [03:29<05:21,  3.97s/it][2024-11-25 19:52:59][slam_llm.models.slam_model][INFO] - modality encoder

 51%|█████     | 83/163 [03:30<03:55,  2.94s/it][2024-11-25 19:52:59][slam_llm.models.slam_model][INFO] - modality encoder

 52%|█████▏    | 84/163 [03:31<02:56,  2.23s/it][2024-11-25 19:53:00][slam_llm.models.slam_model][INFO] - modality encoder

 52%|█████▏    | 85/163 [03:31<02:17,  1.77s/it][2024-11-25 19:53:00][slam_llm.models.slam_model][INFO] - modality encoder

 53%|█████▎    | 86/163 [03:32<01:47,  1.40s/it][2024-11-25 19:53:01][slam_llm.models.slam_model][INFO] - modality encoder

 53%|█████▎    | 87/163 [03:32<01:26,  1.14s/it][2024-11-25 19:53:01][slam_llm.models.slam_model][INFO] - modality encoder

 54%|█████▍    | 88/163 [03:38<03:05,  2.47s/it][2024-11-25 19:53:07][slam_llm.models.slam_model][INFO] - modality encoder

 55%|█████▍    | 89/163 [03:39<02:30,  2.03s/it][2024-11-25 19:53:08][slam_llm.models.slam_model][INFO] - modality encoder

 55%|█████▌    | 90/163 [03:46<04:20,  3.57s/it][2024-11-25 19:53:15][slam_llm.models.slam_model][INFO] - modality encoder

 56%|█████▌    | 91/163 [03:48<03:44,  3.12s/it][2024-11-25 19:53:17][slam_llm.models.slam_model][INFO] - modality encoder

 56%|█████▋    | 92/163 [03:50<03:15,  2.76s/it][2024-11-25 19:53:19][slam_llm.models.slam_model][INFO] - modality encoder

 57%|█████▋    | 93/163 [03:57<04:48,  4.12s/it][2024-11-25 19:53:27][slam_llm.models.slam_model][INFO] - modality encoder

 58%|█████▊    | 94/163 [04:03<05:22,  4.68s/it][2024-11-25 19:53:33][slam_llm.models.slam_model][INFO] - modality encoder

 58%|█████▊    | 95/163 [04:05<04:09,  3.67s/it][2024-11-25 19:53:34][slam_llm.models.slam_model][INFO] - modality encoder

 59%|█████▉    | 96/163 [04:06<03:14,  2.91s/it][2024-11-25 19:53:35][slam_llm.models.slam_model][INFO] - modality encoder

 60%|█████▉    | 97/163 [04:07<02:32,  2.31s/it][2024-11-25 19:53:36][slam_llm.models.slam_model][INFO] - modality encoder

 60%|██████    | 98/163 [04:13<03:41,  3.41s/it][2024-11-25 19:53:42][slam_llm.models.slam_model][INFO] - modality encoder

 61%|██████    | 99/163 [04:19<04:31,  4.25s/it][2024-11-25 19:53:48][slam_llm.models.slam_model][INFO] - modality encoder

 61%|██████▏   | 100/163 [04:26<05:13,  4.98s/it][2024-11-25 19:53:55][slam_llm.models.slam_model][INFO] - modality encoder

 62%|██████▏   | 101/163 [04:26<03:44,  3.62s/it][2024-11-25 19:53:55][slam_llm.models.slam_model][INFO] - modality encoder

 63%|██████▎   | 102/163 [04:32<04:20,  4.27s/it][2024-11-25 19:54:01][slam_llm.models.slam_model][INFO] - modality encoder

 63%|██████▎   | 103/163 [04:32<03:07,  3.12s/it][2024-11-25 19:54:01][slam_llm.models.slam_model][INFO] - modality encoder

 64%|██████▍   | 104/163 [04:33<02:17,  2.33s/it][2024-11-25 19:54:02][slam_llm.models.slam_model][INFO] - modality encoder

 64%|██████▍   | 105/163 [04:33<01:43,  1.78s/it][2024-11-25 19:54:02][slam_llm.models.slam_model][INFO] - modality encoder

 65%|██████▌   | 106/163 [04:39<02:47,  2.94s/it][2024-11-25 19:54:08][slam_llm.models.slam_model][INFO] - modality encoder

 66%|██████▌   | 107/163 [04:39<02:02,  2.19s/it][2024-11-25 19:54:08][slam_llm.models.slam_model][INFO] - modality encoder

 66%|██████▋   | 108/163 [04:40<01:33,  1.69s/it][2024-11-25 19:54:09][slam_llm.models.slam_model][INFO] - modality encoder

 67%|██████▋   | 109/163 [04:40<01:12,  1.33s/it][2024-11-25 19:54:09][slam_llm.models.slam_model][INFO] - modality encoder

 67%|██████▋   | 110/163 [04:41<00:57,  1.08s/it][2024-11-25 19:54:10][slam_llm.models.slam_model][INFO] - modality encoder

 68%|██████▊   | 111/163 [04:41<00:47,  1.10it/s][2024-11-25 19:54:10][slam_llm.models.slam_model][INFO] - modality encoder

 69%|██████▊   | 112/163 [04:47<01:57,  2.31s/it][2024-11-25 19:54:16][slam_llm.models.slam_model][INFO] - modality encoder

 69%|██████▉   | 113/163 [04:53<02:46,  3.34s/it][2024-11-25 19:54:22][slam_llm.models.slam_model][INFO] - modality encoder

 70%|██████▉   | 114/163 [04:58<03:16,  4.01s/it][2024-11-25 19:54:27][slam_llm.models.slam_model][INFO] - modality encoder

 71%|███████   | 115/163 [04:59<02:31,  3.16s/it][2024-11-25 19:54:29][slam_llm.models.slam_model][INFO] - modality encoder

 71%|███████   | 116/163 [05:01<02:01,  2.59s/it][2024-11-25 19:54:30][slam_llm.models.slam_model][INFO] - modality encoder

 72%|███████▏  | 117/163 [05:01<01:31,  2.00s/it][2024-11-25 19:54:30][slam_llm.models.slam_model][INFO] - modality encoder

 72%|███████▏  | 118/163 [05:07<02:16,  3.03s/it][2024-11-25 19:54:36][slam_llm.models.slam_model][INFO] - modality encoder

 73%|███████▎  | 119/163 [05:07<01:41,  2.32s/it][2024-11-25 19:54:37][slam_llm.models.slam_model][INFO] - modality encoder

 74%|███████▎  | 120/163 [05:13<02:19,  3.25s/it][2024-11-25 19:54:42][slam_llm.models.slam_model][INFO] - modality encoder

 74%|███████▍  | 121/163 [05:13<01:41,  2.42s/it][2024-11-25 19:54:42][slam_llm.models.slam_model][INFO] - modality encoder

 75%|███████▍  | 122/163 [05:19<02:18,  3.39s/it][2024-11-25 19:54:48][slam_llm.models.slam_model][INFO] - modality encoder

 75%|███████▌  | 123/163 [05:20<01:45,  2.63s/it][2024-11-25 19:54:49][slam_llm.models.slam_model][INFO] - modality encoder

 76%|███████▌  | 124/163 [05:25<02:18,  3.55s/it][2024-11-25 19:54:55][slam_llm.models.slam_model][INFO] - modality encoder

 77%|███████▋  | 125/163 [05:27<01:50,  2.90s/it][2024-11-25 19:54:56][slam_llm.models.slam_model][INFO] - modality encoder

 77%|███████▋  | 126/163 [05:27<01:21,  2.20s/it][2024-11-25 19:54:57][slam_llm.models.slam_model][INFO] - modality encoder

 78%|███████▊  | 127/163 [05:28<00:59,  1.66s/it][2024-11-25 19:54:57][slam_llm.models.slam_model][INFO] - modality encoder

 79%|███████▊  | 128/163 [05:28<00:46,  1.32s/it][2024-11-25 19:54:58][slam_llm.models.slam_model][INFO] - modality encoder

 79%|███████▉  | 129/163 [05:29<00:37,  1.11s/it][2024-11-25 19:54:58][slam_llm.models.slam_model][INFO] - modality encoder

 80%|███████▉  | 130/163 [05:30<00:31,  1.04it/s][2024-11-25 19:54:59][slam_llm.models.slam_model][INFO] - modality encoder

 80%|████████  | 131/163 [05:30<00:26,  1.19it/s][2024-11-25 19:54:59][slam_llm.models.slam_model][INFO] - modality encoder

 81%|████████  | 132/163 [05:31<00:25,  1.23it/s][2024-11-25 19:55:00][slam_llm.models.slam_model][INFO] - modality encoder

 82%|████████▏ | 133/163 [05:31<00:22,  1.36it/s][2024-11-25 19:55:01][slam_llm.models.slam_model][INFO] - modality encoder

 82%|████████▏ | 134/163 [05:32<00:19,  1.51it/s][2024-11-25 19:55:01][slam_llm.models.slam_model][INFO] - modality encoder

 83%|████████▎ | 135/163 [05:34<00:28,  1.03s/it][2024-11-25 19:55:03][slam_llm.models.slam_model][INFO] - modality encoder

 83%|████████▎ | 136/163 [05:34<00:24,  1.11it/s][2024-11-25 19:55:04][slam_llm.models.slam_model][INFO] - modality encoder

 84%|████████▍ | 137/163 [05:35<00:21,  1.21it/s][2024-11-25 19:55:04][slam_llm.models.slam_model][INFO] - modality encoder

 85%|████████▍ | 138/163 [05:36<00:19,  1.28it/s][2024-11-25 19:55:05][slam_llm.models.slam_model][INFO] - modality encoder

 85%|████████▌ | 139/163 [05:42<00:55,  2.30s/it][2024-11-25 19:55:11][slam_llm.models.slam_model][INFO] - modality encoder

 86%|████████▌ | 140/163 [05:42<00:40,  1.75s/it][2024-11-25 19:55:11][slam_llm.models.slam_model][INFO] - modality encoder

 87%|████████▋ | 141/163 [05:43<00:32,  1.46s/it][2024-11-25 19:55:12][slam_llm.models.slam_model][INFO] - modality encoder

 87%|████████▋ | 142/163 [05:43<00:24,  1.18s/it][2024-11-25 19:55:13][slam_llm.models.slam_model][INFO] - modality encoder

 88%|████████▊ | 143/163 [05:49<00:50,  2.54s/it][2024-11-25 19:55:18][slam_llm.models.slam_model][INFO] - modality encoder

 88%|████████▊ | 144/163 [05:50<00:37,  1.97s/it][2024-11-25 19:55:19][slam_llm.models.slam_model][INFO] - modality encoder

 89%|████████▉ | 145/163 [05:50<00:28,  1.57s/it][2024-11-25 19:55:20][slam_llm.models.slam_model][INFO] - modality encoder

 90%|████████▉ | 146/163 [05:51<00:22,  1.35s/it][2024-11-25 19:55:20][slam_llm.models.slam_model][INFO] - modality encoder

 90%|█████████ | 147/163 [05:52<00:18,  1.17s/it][2024-11-25 19:55:21][slam_llm.models.slam_model][INFO] - modality encoder

 91%|█████████ | 148/163 [05:57<00:37,  2.50s/it][2024-11-25 19:55:27][slam_llm.models.slam_model][INFO] - modality encoder

 91%|█████████▏| 149/163 [05:58<00:26,  1.92s/it][2024-11-25 19:55:27][slam_llm.models.slam_model][INFO] - modality encoder

 92%|█████████▏| 150/163 [05:59<00:20,  1.55s/it][2024-11-25 19:55:28][slam_llm.models.slam_model][INFO] - modality encoder

 93%|█████████▎| 151/163 [06:00<00:17,  1.49s/it][2024-11-25 19:55:29][slam_llm.models.slam_model][INFO] - modality encoder

 93%|█████████▎| 152/163 [06:06<00:30,  2.80s/it][2024-11-25 19:55:35][slam_llm.models.slam_model][INFO] - modality encoder

 94%|█████████▍| 153/163 [06:14<00:43,  4.31s/it][2024-11-25 19:55:43][slam_llm.models.slam_model][INFO] - modality encoder

 94%|█████████▍| 154/163 [06:19<00:42,  4.69s/it][2024-11-25 19:55:49][slam_llm.models.slam_model][INFO] - modality encoder

 95%|█████████▌| 155/163 [06:26<00:41,  5.14s/it][2024-11-25 19:55:55][slam_llm.models.slam_model][INFO] - modality encoder

 96%|█████████▌| 156/163 [06:26<00:26,  3.73s/it][2024-11-25 19:55:55][slam_llm.models.slam_model][INFO] - modality encoder

 96%|█████████▋| 157/163 [06:26<00:16,  2.75s/it][2024-11-25 19:55:56][slam_llm.models.slam_model][INFO] - modality encoder

 97%|█████████▋| 158/163 [06:27<00:10,  2.06s/it][2024-11-25 19:55:56][slam_llm.models.slam_model][INFO] - modality encoder

 98%|█████████▊| 159/163 [06:28<00:06,  1.68s/it][2024-11-25 19:55:57][slam_llm.models.slam_model][INFO] - modality encoder

 98%|█████████▊| 160/163 [06:29<00:04,  1.48s/it][2024-11-25 19:55:58][slam_llm.models.slam_model][INFO] - modality encoder

 99%|█████████▉| 161/163 [06:29<00:02,  1.19s/it][2024-11-25 19:55:59][slam_llm.models.slam_model][INFO] - modality encoder

 99%|█████████▉| 162/163 [06:36<00:02,  2.99s/it][2024-11-25 19:56:06][slam_llm.models.slam_model][INFO] - modality encoder

100%|██████████| 163/163 [06:42<00:00,  3.84s/it]
100%|██████████| 163/163 [06:42<00:00,  2.47s/it]
Using folder: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_linear_peft
Initial Word Error Rate (WER) before filtering: 2.1717557251908395
Number of GT lines after filtering: 629
Number of original PRED lines: 652
Number of filtered repeated lines: 23 out of 652
Lines with repeated words or phrases in PRED file:
- AH B EY B IY D R AO L IH NG N OW AH N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW
- OW AH M IY Y AE AH Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE
- Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE Y AE
- HH IY Y AE N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N
- OW K EY HH IY Y AE OW Y AE OW Y AE AH OW AH OW W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W AY W
- DH EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B E
- AH M <sil> B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY
- JH IY S K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K AE K
- AH M L AH M AE N D AH P UH DX IH NG AH G L EH S IH NG D R IH NG K R IH NG K IH NG AO R S AH M TH IH NG AH D UW W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH W UH
- AH M B EY B IY K AE W AH T S N OW N OW M B UH T Y AE AH P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY P EY
- AH AH HH IY Z G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G E
- AH N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N AY N
- AH M EY L EY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L
- HH EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G EY G E
- AH <sil> AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY AY
- AH L AY AH L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY L AY
- AH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P UH P
- HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE
- DH EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L E
- OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P OW P
- AH M <sil> AH M <sil> AH M <sil> S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S
- SH S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S
- AH M EY L AE N D T IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY
Filtered Word Error Rate (WER) after removing repeated lines: 1.748696219035202
Configuration:
Task: test
Prompt Flag: 
Config File: whisper-mono
Epochs: 10
Batch Size: 4
Data Folder: psst_phoneme
Use PEFT: true
LLM Name: llama32_1b
Freeze Encoder: true
speech encoder name: whisper
speech encoder path: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt
speech encoder2 name: 
speech encoder2 path: 
llm_path: 
Identifier: 
use_peft: true
use_fp16: 
Final identifier: psst_phoneme_whisper_llama32_1b_linear_peft
Latest file: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_10_step_554_loss_0.8507750630378723/model.pt
ckpt_folder: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_10_step_554_loss_0.8507750630378723
Resume epoch: 10
Resume step: 554
Selected lowest loss checkpoint: asr_epoch_6_step_133_loss_0.6664179563522339
Checkpoint file: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_6_step_133_loss_0.6664179563522339/model.pt
ckpt_folder /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_6_step_133_loss_0.6664179563522339
[2024-11-25 19:56:30][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-25 19:56:30][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-25 19:56:30][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'whisper', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Whisper/large-v3.pt', 'encoder_dim': 1280, 'encoder_projector': 'linear', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': '', 'encoder2_dim': 1024, 'encoder2_path': ''}
[2024-11-25 19:56:54][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-25 19:56:54][slam_llm.utils.train_utils][INFO] - --> whisper has 635.04896 Million params

[2024-11-25 19:56:54][slam_llm.utils.train_utils][INFO] - --> Module whisper
[2024-11-25 19:56:54][slam_llm.utils.train_utils][INFO] - --> whisper has 0.0 Million params

[2024-11-25 19:56:57][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 19:56:57][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-25 19:56:57][slam_llm.models.slam_model][INFO] - setup peft...
trainable params: 5,636,096 || all params: 1,241,450,496 || trainable%: 0.4539928106807088
[2024-11-25 19:56:57][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 19:56:57][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-25 19:56:58][slam_llm.utils.train_utils][INFO] - --> Module linear
[2024-11-25 19:56:58][slam_llm.utils.train_utils][INFO] - --> linear has 17.3056 Million params

[2024-11-25 19:56:58][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft/asr_epoch_6_step_133_loss_0.6664179563522339/model.pt
[2024-11-25 19:56:58][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-25 19:56:58][slam_llm.utils.train_utils][INFO] - --> asr has 22.941696 Million params

[2024-11-25 19:57:00][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'mel', 'mel_size': 128, 'normalize': True}
[2024-11-25 19:57:00][root][INFO] - --> Training Set Length = 652
[2024-11-25 19:57:00][root][INFO] - =====================================

  0%|          | 0/163 [00:00<?, ?it/s][2024-11-25 19:57:02][slam_llm.models.slam_model][INFO] - modality encoder
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.7` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.92` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(

  1%|          | 1/163 [00:03<09:38,  3.57s/it][2024-11-25 19:57:04][slam_llm.models.slam_model][INFO] - modality encoder

  1%|          | 2/163 [00:05<07:06,  2.65s/it][2024-11-25 19:57:06][slam_llm.models.slam_model][INFO] - modality encoder

  2%|▏         | 3/163 [00:07<06:16,  2.36s/it][2024-11-25 19:57:08][slam_llm.models.slam_model][INFO] - modality encoder

  2%|▏         | 4/163 [00:09<06:03,  2.29s/it][2024-11-25 19:57:10][slam_llm.models.slam_model][INFO] - modality encoder

  3%|▎         | 5/163 [00:12<06:09,  2.34s/it][2024-11-25 19:57:13][slam_llm.models.slam_model][INFO] - modality encoder

  4%|▎         | 6/163 [00:15<06:37,  2.53s/it][2024-11-25 19:57:16][slam_llm.models.slam_model][INFO] - modality encoder

  4%|▍         | 7/163 [00:17<06:31,  2.51s/it][2024-11-25 19:57:18][slam_llm.models.slam_model][INFO] - modality encoder

  5%|▍         | 8/163 [00:19<06:14,  2.42s/it][2024-11-25 19:57:20][slam_llm.models.slam_model][INFO] - modality encoder

  6%|▌         | 9/163 [00:27<10:21,  4.04s/it][2024-11-25 19:57:28][slam_llm.models.slam_model][INFO] - modality encoder

  6%|▌         | 10/163 [00:29<09:02,  3.55s/it][2024-11-25 19:57:30][slam_llm.models.slam_model][INFO] - modality encoder

  7%|▋         | 11/163 [00:32<08:03,  3.18s/it][2024-11-25 19:57:33][slam_llm.models.slam_model][INFO] - modality encoder

  7%|▋         | 12/163 [00:34<07:29,  2.98s/it][2024-11-25 19:57:35][slam_llm.models.slam_model][INFO] - modality encoder

  8%|▊         | 13/163 [00:37<06:58,  2.79s/it][2024-11-25 19:57:38][slam_llm.models.slam_model][INFO] - modality encoder

  9%|▊         | 14/163 [00:39<06:52,  2.77s/it][2024-11-25 19:57:40][slam_llm.models.slam_model][INFO] - modality encoder

  9%|▉         | 15/163 [00:41<06:13,  2.53s/it][2024-11-25 19:57:42][slam_llm.models.slam_model][INFO] - modality encoder

 10%|▉         | 16/163 [00:43<05:55,  2.42s/it][2024-11-25 19:57:44][slam_llm.models.slam_model][INFO] - modality encoder

 10%|█         | 17/163 [00:51<09:45,  4.01s/it][2024-11-25 19:57:52][slam_llm.models.slam_model][INFO] - modality encoder

 11%|█         | 18/163 [00:53<08:20,  3.45s/it][2024-11-25 19:57:54][slam_llm.models.slam_model][INFO] - modality encoder

 12%|█▏        | 19/163 [00:56<07:24,  3.09s/it][2024-11-25 19:57:56][slam_llm.models.slam_model][INFO] - modality encoder

 12%|█▏        | 20/163 [00:58<06:54,  2.90s/it][2024-11-25 19:57:59][slam_llm.models.slam_model][INFO] - modality encoder

 13%|█▎        | 21/163 [01:00<06:14,  2.64s/it][2024-11-25 19:58:01][slam_llm.models.slam_model][INFO] - modality encoder

 13%|█▎        | 22/163 [01:02<05:43,  2.44s/it][2024-11-25 19:58:03][slam_llm.models.slam_model][INFO] - modality encoder

 14%|█▍        | 23/163 [01:04<05:33,  2.38s/it][2024-11-25 19:58:05][slam_llm.models.slam_model][INFO] - modality encoder

 15%|█▍        | 24/163 [01:07<05:35,  2.41s/it][2024-11-25 19:58:08][slam_llm.models.slam_model][INFO] - modality encoder

 15%|█▌        | 25/163 [01:09<05:44,  2.50s/it][2024-11-25 19:58:10][slam_llm.models.slam_model][INFO] - modality encoder

 16%|█▌        | 26/163 [01:12<05:33,  2.43s/it][2024-11-25 19:58:13][slam_llm.models.slam_model][INFO] - modality encoder

 17%|█▋        | 27/163 [01:14<05:18,  2.34s/it][2024-11-25 19:58:15][slam_llm.models.slam_model][INFO] - modality encoder

 17%|█▋        | 28/163 [01:16<05:17,  2.35s/it][2024-11-25 19:58:17][slam_llm.models.slam_model][INFO] - modality encoder

 18%|█▊        | 29/163 [01:18<05:09,  2.31s/it][2024-11-25 19:58:19][slam_llm.models.slam_model][INFO] - modality encoder

 18%|█▊        | 30/163 [01:20<04:56,  2.23s/it][2024-11-25 19:58:21][slam_llm.models.slam_model][INFO] - modality encoder

 19%|█▉        | 31/163 [01:23<04:48,  2.19s/it][2024-11-25 19:58:24][slam_llm.models.slam_model][INFO] - modality encoder

 20%|█▉        | 32/163 [01:25<04:41,  2.15s/it][2024-11-25 19:58:26][slam_llm.models.slam_model][INFO] - modality encoder

 20%|██        | 33/163 [01:27<04:35,  2.12s/it][2024-11-25 19:58:28][slam_llm.models.slam_model][INFO] - modality encoder

 21%|██        | 34/163 [01:29<04:40,  2.18s/it][2024-11-25 19:58:30][slam_llm.models.slam_model][INFO] - modality encoder

 21%|██▏       | 35/163 [01:31<04:40,  2.19s/it][2024-11-25 19:58:32][slam_llm.models.slam_model][INFO] - modality encoder

 22%|██▏       | 36/163 [01:34<04:48,  2.27s/it][2024-11-25 19:58:35][slam_llm.models.slam_model][INFO] - modality encoder

 23%|██▎       | 37/163 [01:36<04:36,  2.20s/it][2024-11-25 19:58:37][slam_llm.models.slam_model][INFO] - modality encoder

 23%|██▎       | 38/163 [01:38<04:32,  2.18s/it][2024-11-25 19:58:39][slam_llm.models.slam_model][INFO] - modality encoder

 24%|██▍       | 39/163 [01:40<04:33,  2.20s/it][2024-11-25 19:58:41][slam_llm.models.slam_model][INFO] - modality encoder

 25%|██▍       | 40/163 [01:42<04:36,  2.24s/it][2024-11-25 19:58:43][slam_llm.models.slam_model][INFO] - modality encoder

 25%|██▌       | 41/163 [01:45<04:32,  2.23s/it][2024-11-25 19:58:46][slam_llm.models.slam_model][INFO] - modality encoder

 26%|██▌       | 42/163 [01:47<04:29,  2.23s/it][2024-11-25 19:58:48][slam_llm.models.slam_model][INFO] - modality encoder

 26%|██▋       | 43/163 [01:49<04:19,  2.16s/it][2024-11-25 19:58:50][slam_llm.models.slam_model][INFO] - modality encoder

 27%|██▋       | 44/163 [01:51<04:18,  2.18s/it][2024-11-25 19:58:52][slam_llm.models.slam_model][INFO] - modality encoder

 28%|██▊       | 45/163 [01:53<04:13,  2.15s/it][2024-11-25 19:58:54][slam_llm.models.slam_model][INFO] - modality encoder

 28%|██▊       | 46/163 [01:55<04:04,  2.09s/it][2024-11-25 19:58:56][slam_llm.models.slam_model][INFO] - modality encoder

 29%|██▉       | 47/163 [01:58<04:28,  2.32s/it][2024-11-25 19:58:59][slam_llm.models.slam_model][INFO] - modality encoder

 29%|██▉       | 48/163 [02:00<04:29,  2.34s/it][2024-11-25 19:59:01][slam_llm.models.slam_model][INFO] - modality encoder

 30%|███       | 49/163 [02:03<04:40,  2.46s/it][2024-11-25 19:59:04][slam_llm.models.slam_model][INFO] - modality encoder

 31%|███       | 50/163 [02:06<04:48,  2.55s/it][2024-11-25 19:59:07][slam_llm.models.slam_model][INFO] - modality encoder

 31%|███▏      | 51/163 [02:08<04:29,  2.41s/it][2024-11-25 19:59:09][slam_llm.models.slam_model][INFO] - modality encoder

 32%|███▏      | 52/163 [02:10<04:14,  2.30s/it][2024-11-25 19:59:11][slam_llm.models.slam_model][INFO] - modality encoder

 33%|███▎      | 53/163 [02:12<04:04,  2.23s/it][2024-11-25 19:59:13][slam_llm.models.slam_model][INFO] - modality encoder

 33%|███▎      | 54/163 [02:14<03:55,  2.16s/it][2024-11-25 19:59:15][slam_llm.models.slam_model][INFO] - modality encoder

 34%|███▎      | 55/163 [02:17<04:09,  2.31s/it][2024-11-25 19:59:18][slam_llm.models.slam_model][INFO] - modality encoder

 34%|███▍      | 56/163 [02:19<04:09,  2.33s/it][2024-11-25 19:59:20][slam_llm.models.slam_model][INFO] - modality encoder

 35%|███▍      | 57/163 [02:21<04:05,  2.32s/it][2024-11-25 19:59:22][slam_llm.models.slam_model][INFO] - modality encoder

 36%|███▌      | 58/163 [02:24<04:20,  2.48s/it][2024-11-25 19:59:25][slam_llm.models.slam_model][INFO] - modality encoder

 36%|███▌      | 59/163 [02:27<04:15,  2.46s/it][2024-11-25 19:59:28][slam_llm.models.slam_model][INFO] - modality encoder

 37%|███▋      | 60/163 [02:29<04:00,  2.33s/it][2024-11-25 19:59:30][slam_llm.models.slam_model][INFO] - modality encoder

 37%|███▋      | 61/163 [02:31<04:07,  2.43s/it][2024-11-25 19:59:32][slam_llm.models.slam_model][INFO] - modality encoder

 38%|███▊      | 62/163 [02:34<04:05,  2.43s/it][2024-11-25 19:59:35][slam_llm.models.slam_model][INFO] - modality encoder

 39%|███▊      | 63/163 [02:37<04:13,  2.54s/it][2024-11-25 19:59:37][slam_llm.models.slam_model][INFO] - modality encoder

 39%|███▉      | 64/163 [02:44<06:42,  4.07s/it][2024-11-25 19:59:45][slam_llm.models.slam_model][INFO] - modality encoder

 40%|███▉      | 65/163 [02:47<06:14,  3.82s/it][2024-11-25 19:59:48][slam_llm.models.slam_model][INFO] - modality encoder

 40%|████      | 66/163 [02:50<05:34,  3.45s/it][2024-11-25 19:59:51][slam_llm.models.slam_model][INFO] - modality encoder

 41%|████      | 67/163 [02:52<04:46,  2.98s/it][2024-11-25 19:59:53][slam_llm.models.slam_model][INFO] - modality encoder

 42%|████▏     | 68/163 [02:54<04:16,  2.70s/it][2024-11-25 19:59:55][slam_llm.models.slam_model][INFO] - modality encoder

 42%|████▏     | 69/163 [02:56<04:04,  2.60s/it][2024-11-25 19:59:57][slam_llm.models.slam_model][INFO] - modality encoder

 43%|████▎     | 70/163 [02:58<03:45,  2.42s/it][2024-11-25 19:59:59][slam_llm.models.slam_model][INFO] - modality encoder

 44%|████▎     | 71/163 [03:01<03:37,  2.37s/it][2024-11-25 20:00:02][slam_llm.models.slam_model][INFO] - modality encoder

 44%|████▍     | 72/163 [03:03<03:45,  2.48s/it][2024-11-25 20:00:04][slam_llm.models.slam_model][INFO] - modality encoder

 45%|████▍     | 73/163 [03:06<03:38,  2.43s/it][2024-11-25 20:00:07][slam_llm.models.slam_model][INFO] - modality encoder

 45%|████▌     | 74/163 [03:08<03:24,  2.30s/it][2024-11-25 20:00:09][slam_llm.models.slam_model][INFO] - modality encoder

 46%|████▌     | 75/163 [03:10<03:15,  2.22s/it][2024-11-25 20:00:11][slam_llm.models.slam_model][INFO] - modality encoder

 47%|████▋     | 76/163 [03:17<05:34,  3.85s/it][2024-11-25 20:00:18][slam_llm.models.slam_model][INFO] - modality encoder

 47%|████▋     | 77/163 [03:25<07:09,  4.99s/it][2024-11-25 20:00:26][slam_llm.models.slam_model][INFO] - modality encoder

 48%|████▊     | 78/163 [03:28<06:07,  4.32s/it][2024-11-25 20:00:29][slam_llm.models.slam_model][INFO] - modality encoder

 48%|████▊     | 79/163 [03:31<05:34,  3.98s/it][2024-11-25 20:00:32][slam_llm.models.slam_model][INFO] - modality encoder

 49%|████▉     | 80/163 [03:34<05:01,  3.63s/it][2024-11-25 20:00:35][slam_llm.models.slam_model][INFO] - modality encoder

 50%|████▉     | 81/163 [03:37<04:47,  3.51s/it][2024-11-25 20:00:38][slam_llm.models.slam_model][INFO] - modality encoder

 50%|█████     | 82/163 [03:39<04:11,  3.11s/it][2024-11-25 20:00:40][slam_llm.models.slam_model][INFO] - modality encoder

 51%|█████     | 83/163 [03:41<03:40,  2.76s/it][2024-11-25 20:00:42][slam_llm.models.slam_model][INFO] - modality encoder

 52%|█████▏    | 84/163 [03:43<03:25,  2.61s/it][2024-11-25 20:00:44][slam_llm.models.slam_model][INFO] - modality encoder

 52%|█████▏    | 85/163 [03:45<03:10,  2.44s/it][2024-11-25 20:00:46][slam_llm.models.slam_model][INFO] - modality encoder

 53%|█████▎    | 86/163 [03:47<02:59,  2.33s/it][2024-11-25 20:00:48][slam_llm.models.slam_model][INFO] - modality encoder

 53%|█████▎    | 87/163 [03:49<02:52,  2.26s/it][2024-11-25 20:00:50][slam_llm.models.slam_model][INFO] - modality encoder

 54%|█████▍    | 88/163 [03:51<02:42,  2.17s/it][2024-11-25 20:00:52][slam_llm.models.slam_model][INFO] - modality encoder

 55%|█████▍    | 89/163 [03:54<02:43,  2.21s/it][2024-11-25 20:00:55][slam_llm.models.slam_model][INFO] - modality encoder

 55%|█████▌    | 90/163 [03:57<03:03,  2.51s/it][2024-11-25 20:00:58][slam_llm.models.slam_model][INFO] - modality encoder

 56%|█████▌    | 91/163 [04:00<03:12,  2.67s/it][2024-11-25 20:01:01][slam_llm.models.slam_model][INFO] - modality encoder

 56%|█████▋    | 92/163 [04:03<03:10,  2.69s/it][2024-11-25 20:01:04][slam_llm.models.slam_model][INFO] - modality encoder

 57%|█████▋    | 93/163 [04:06<03:20,  2.86s/it][2024-11-25 20:01:07][slam_llm.models.slam_model][INFO] - modality encoder

 58%|█████▊    | 94/163 [04:08<03:08,  2.74s/it][2024-11-25 20:01:09][slam_llm.models.slam_model][INFO] - modality encoder

 58%|█████▊    | 95/163 [04:11<03:05,  2.73s/it][2024-11-25 20:01:12][slam_llm.models.slam_model][INFO] - modality encoder

 59%|█████▉    | 96/163 [04:19<04:40,  4.19s/it][2024-11-25 20:01:20][slam_llm.models.slam_model][INFO] - modality encoder

 60%|█████▉    | 97/163 [04:21<04:06,  3.73s/it][2024-11-25 20:01:22][slam_llm.models.slam_model][INFO] - modality encoder

 60%|██████    | 98/163 [04:25<03:51,  3.56s/it][2024-11-25 20:01:26][slam_llm.models.slam_model][INFO] - modality encoder

 61%|██████    | 99/163 [04:28<03:36,  3.38s/it][2024-11-25 20:01:29][slam_llm.models.slam_model][INFO] - modality encoder

 61%|██████▏   | 100/163 [04:35<04:52,  4.65s/it][2024-11-25 20:01:36][slam_llm.models.slam_model][INFO] - modality encoder

 62%|██████▏   | 101/163 [04:37<04:04,  3.94s/it][2024-11-25 20:01:38][slam_llm.models.slam_model][INFO] - modality encoder

 63%|██████▎   | 102/163 [04:40<03:26,  3.38s/it][2024-11-25 20:01:41][slam_llm.models.slam_model][INFO] - modality encoder

 63%|██████▎   | 103/163 [04:42<02:58,  2.97s/it][2024-11-25 20:01:43][slam_llm.models.slam_model][INFO] - modality encoder

 64%|██████▍   | 104/163 [04:43<02:37,  2.67s/it][2024-11-25 20:01:44][slam_llm.models.slam_model][INFO] - modality encoder

 64%|██████▍   | 105/163 [04:46<02:26,  2.53s/it][2024-11-25 20:01:47][slam_llm.models.slam_model][INFO] - modality encoder

 65%|██████▌   | 106/163 [04:49<02:29,  2.63s/it][2024-11-25 20:01:50][slam_llm.models.slam_model][INFO] - modality encoder

 66%|██████▌   | 107/163 [04:51<02:17,  2.45s/it][2024-11-25 20:01:52][slam_llm.models.slam_model][INFO] - modality encoder

 66%|██████▋   | 108/163 [04:53<02:09,  2.35s/it][2024-11-25 20:01:54][slam_llm.models.slam_model][INFO] - modality encoder

 67%|██████▋   | 109/163 [04:55<02:05,  2.32s/it][2024-11-25 20:01:56][slam_llm.models.slam_model][INFO] - modality encoder

 67%|██████▋   | 110/163 [04:57<01:58,  2.24s/it][2024-11-25 20:01:58][slam_llm.models.slam_model][INFO] - modality encoder

 68%|██████▊   | 111/163 [04:59<01:53,  2.18s/it][2024-11-25 20:02:00][slam_llm.models.slam_model][INFO] - modality encoder

 69%|██████▊   | 112/163 [05:02<01:58,  2.32s/it][2024-11-25 20:02:03][slam_llm.models.slam_model][INFO] - modality encoder

 69%|██████▉   | 113/163 [05:04<01:57,  2.35s/it][2024-11-25 20:02:05][slam_llm.models.slam_model][INFO] - modality encoder

 70%|██████▉   | 114/163 [05:07<01:56,  2.37s/it][2024-11-25 20:02:08][slam_llm.models.slam_model][INFO] - modality encoder

 71%|███████   | 115/163 [05:09<01:50,  2.31s/it][2024-11-25 20:02:10][slam_llm.models.slam_model][INFO] - modality encoder

 71%|███████   | 116/163 [05:11<01:51,  2.38s/it][2024-11-25 20:02:12][slam_llm.models.slam_model][INFO] - modality encoder

 72%|███████▏  | 117/163 [05:13<01:45,  2.30s/it][2024-11-25 20:02:14][slam_llm.models.slam_model][INFO] - modality encoder

 72%|███████▏  | 118/163 [05:15<01:40,  2.23s/it][2024-11-25 20:02:16][slam_llm.models.slam_model][INFO] - modality encoder

 73%|███████▎  | 119/163 [05:18<01:36,  2.20s/it][2024-11-25 20:02:19][slam_llm.models.slam_model][INFO] - modality encoder

 74%|███████▎  | 120/163 [05:20<01:33,  2.16s/it][2024-11-25 20:02:21][slam_llm.models.slam_model][INFO] - modality encoder

 74%|███████▍  | 121/163 [05:22<01:28,  2.12s/it][2024-11-25 20:02:23][slam_llm.models.slam_model][INFO] - modality encoder

 75%|███████▍  | 122/163 [05:24<01:27,  2.12s/it][2024-11-25 20:02:25][slam_llm.models.slam_model][INFO] - modality encoder

 75%|███████▌  | 123/163 [05:26<01:27,  2.18s/it][2024-11-25 20:02:27][slam_llm.models.slam_model][INFO] - modality encoder

 76%|███████▌  | 124/163 [05:34<02:28,  3.81s/it][2024-11-25 20:02:35][slam_llm.models.slam_model][INFO] - modality encoder

 77%|███████▋  | 125/163 [05:36<02:11,  3.45s/it][2024-11-25 20:02:37][slam_llm.models.slam_model][INFO] - modality encoder

 77%|███████▋  | 126/163 [05:38<01:53,  3.07s/it][2024-11-25 20:02:39][slam_llm.models.slam_model][INFO] - modality encoder

 78%|███████▊  | 127/163 [05:40<01:38,  2.74s/it][2024-11-25 20:02:41][slam_llm.models.slam_model][INFO] - modality encoder

 79%|███████▊  | 128/163 [05:42<01:28,  2.53s/it][2024-11-25 20:02:43][slam_llm.models.slam_model][INFO] - modality encoder

 79%|███████▉  | 129/163 [05:45<01:21,  2.41s/it][2024-11-25 20:02:46][slam_llm.models.slam_model][INFO] - modality encoder

 80%|███████▉  | 130/163 [05:47<01:17,  2.34s/it][2024-11-25 20:02:48][slam_llm.models.slam_model][INFO] - modality encoder

 80%|████████  | 131/163 [05:49<01:16,  2.39s/it][2024-11-25 20:02:50][slam_llm.models.slam_model][INFO] - modality encoder

 81%|████████  | 132/163 [05:52<01:12,  2.35s/it][2024-11-25 20:02:53][slam_llm.models.slam_model][INFO] - modality encoder

 82%|████████▏ | 133/163 [05:54<01:08,  2.29s/it][2024-11-25 20:02:55][slam_llm.models.slam_model][INFO] - modality encoder

 82%|████████▏ | 134/163 [05:56<01:04,  2.23s/it][2024-11-25 20:02:57][slam_llm.models.slam_model][INFO] - modality encoder

 83%|████████▎ | 135/163 [05:58<01:04,  2.30s/it][2024-11-25 20:02:59][slam_llm.models.slam_model][INFO] - modality encoder

 83%|████████▎ | 136/163 [06:01<01:02,  2.30s/it][2024-11-25 20:03:02][slam_llm.models.slam_model][INFO] - modality encoder

 84%|████████▍ | 137/163 [06:03<00:58,  2.26s/it][2024-11-25 20:03:04][slam_llm.models.slam_model][INFO] - modality encoder

 85%|████████▍ | 138/163 [06:05<00:55,  2.23s/it][2024-11-25 20:03:06][slam_llm.models.slam_model][INFO] - modality encoder

 85%|████████▌ | 139/163 [06:08<00:56,  2.37s/it][2024-11-25 20:03:09][slam_llm.models.slam_model][INFO] - modality encoder

 86%|████████▌ | 140/163 [06:10<00:51,  2.26s/it][2024-11-25 20:03:11][slam_llm.models.slam_model][INFO] - modality encoder

 87%|████████▋ | 141/163 [06:12<00:48,  2.22s/it][2024-11-25 20:03:13][slam_llm.models.slam_model][INFO] - modality encoder

 87%|████████▋ | 142/163 [06:14<00:46,  2.20s/it][2024-11-25 20:03:15][slam_llm.models.slam_model][INFO] - modality encoder

 88%|████████▊ | 143/163 [06:17<00:47,  2.35s/it][2024-11-25 20:03:18][slam_llm.models.slam_model][INFO] - modality encoder

 88%|████████▊ | 144/163 [06:19<00:43,  2.28s/it][2024-11-25 20:03:20][slam_llm.models.slam_model][INFO] - modality encoder

 89%|████████▉ | 145/163 [06:21<00:40,  2.26s/it][2024-11-25 20:03:22][slam_llm.models.slam_model][INFO] - modality encoder

 90%|████████▉ | 146/163 [06:23<00:38,  2.28s/it][2024-11-25 20:03:24][slam_llm.models.slam_model][INFO] - modality encoder

 90%|█████████ | 147/163 [06:25<00:35,  2.25s/it][2024-11-25 20:03:26][slam_llm.models.slam_model][INFO] - modality encoder

 91%|█████████ | 148/163 [06:27<00:32,  2.19s/it][2024-11-25 20:03:28][slam_llm.models.slam_model][INFO] - modality encoder

 91%|█████████▏| 149/163 [06:30<00:30,  2.18s/it][2024-11-25 20:03:31][slam_llm.models.slam_model][INFO] - modality encoder

 92%|█████████▏| 150/163 [06:32<00:28,  2.17s/it][2024-11-25 20:03:33][slam_llm.models.slam_model][INFO] - modality encoder

 93%|█████████▎| 151/163 [06:34<00:27,  2.27s/it][2024-11-25 20:03:35][slam_llm.models.slam_model][INFO] - modality encoder

 93%|█████████▎| 152/163 [06:36<00:24,  2.26s/it][2024-11-25 20:03:37][slam_llm.models.slam_model][INFO] - modality encoder

 94%|█████████▍| 153/163 [06:44<00:39,  3.90s/it][2024-11-25 20:03:45][slam_llm.models.slam_model][INFO] - modality encoder

 94%|█████████▍| 154/163 [06:52<00:45,  5.02s/it][2024-11-25 20:03:53][slam_llm.models.slam_model][INFO] - modality encoder

 95%|█████████▌| 155/163 [06:54<00:34,  4.27s/it][2024-11-25 20:03:55][slam_llm.models.slam_model][INFO] - modality encoder

 96%|█████████▌| 156/163 [06:56<00:25,  3.58s/it][2024-11-25 20:03:57][slam_llm.models.slam_model][INFO] - modality encoder

 96%|█████████▋| 157/163 [06:58<00:18,  3.11s/it][2024-11-25 20:03:59][slam_llm.models.slam_model][INFO] - modality encoder

 97%|█████████▋| 158/163 [07:00<00:13,  2.77s/it][2024-11-25 20:04:01][slam_llm.models.slam_model][INFO] - modality encoder

 98%|█████████▊| 159/163 [07:03<00:10,  2.62s/it][2024-11-25 20:04:04][slam_llm.models.slam_model][INFO] - modality encoder

 98%|█████████▊| 160/163 [07:05<00:07,  2.53s/it][2024-11-25 20:04:06][slam_llm.models.slam_model][INFO] - modality encoder

 99%|█████████▉| 161/163 [07:07<00:04,  2.39s/it][2024-11-25 20:04:08][slam_llm.models.slam_model][INFO] - modality encoder

 99%|█████████▉| 162/163 [07:15<00:03,  3.96s/it][2024-11-25 20:04:16][slam_llm.models.slam_model][INFO] - modality encoder

100%|██████████| 163/163 [07:17<00:00,  3.51s/it]
100%|██████████| 163/163 [07:17<00:00,  2.69s/it]
Using folder: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_whisper_llama32_1b_linear_peft
Initial Word Error Rate (WER) before filtering: 0.6389312977099236
Number of GT lines after filtering: 648
Number of original PRED lines: 652
Number of filtered repeated lines: 4 out of 652
Lines with repeated words or phrases in PRED file:
- K AO R K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K K
- AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B AH B
- SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW SH UW
- SH AH V SH AH V K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW K OW
Filtered Word Error Rate (WER) after removing repeated lines: 0.5261205564142195
Configuration:
Task: test
Prompt Flag: 
Config File: w2p-wavlm-dual
Epochs: 10
Batch Size: 4
Data Folder: psst_phoneme
Use PEFT: true
LLM Name: llama32_1b
Freeze Encoder: true
speech encoder name: wavlm
speech encoder path: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/WavLM-Large.pt
speech encoder2 name: w2v2
speech encoder2 path: vitouphy/wav2vec2-xls-r-300m-timit-phoneme
llm_path: 
Identifier: 
use_peft: true
use_fp16: 
Final identifier: psst_phoneme_wavlm_llama32_1b_dual_peft
Latest file: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft/asr_epoch_10_step_554_loss_0.9401524662971497/model.pt
ckpt_folder: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft/asr_epoch_10_step_554_loss_0.9401524662971497
Resume epoch: 10
Resume step: 554
Selected lowest loss checkpoint: asr_epoch_4_step_137_loss_0.7482238411903381
Checkpoint file: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft/asr_epoch_4_step_137_loss_0.7482238411903381/model.pt
ckpt_folder /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft/asr_epoch_4_step_137_loss_0.7482238411903381
[2024-11-25 20:04:43][root][INFO] - train_config: {'model_name': 'asr', 'enable_ddp': False, 'enable_deepspeed': False, 'enable_fsdp': False, 'low_cpu_fsdp': False, 'run_validation': True, 'batch_size_training': 4, 'batching_strategy': 'custom', 'context_length': 4096, 'gradient_accumulation_steps': 1, 'num_epochs': 1, 'resume_step': 0, 'resume_epoch': 0, 'num_workers_dataloader': 1, 'warmup_steps': 1000, 'total_steps': 100000, 'validation_interval': 1000, 'lr': 0.0001, 'weight_decay': 0.0, 'gamma': 0.85, 'seed': 42, 'use_fp16': False, 'mixed_precision': True, 'val_batch_size': 4, 'use_peft': True, 'peft_config': {'peft_method': 'lora', 'r': 8, 'lora_alpha': 32, 'target_modules': ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'up_proj', 'gate_proj', 'down_proj'], 'bias': 'none', 'task_type': 'CAUSAL_LM', 'lora_dropout': 0.05, 'inference_mode': False}, 'output_dir': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft', 'freeze_layers': False, 'num_freeze_layers': 1, 'quantization': False, 'one_gpu': False, 'save_model': True, 'dist_checkpoint_root_folder': 'PATH/to/save/FSDP/model', 'dist_checkpoint_folder': 'fine-tuned', 'save_optimizer': False, 'use_fast_kernels': False, 'run_test_during_validation': False, 'run_test_during_validation_file': 'test.wav', 'run_test_during_validation_prompt': '<|ASR|>', 'freeze_llm': True, 'freeze_encoder': True, 'freeze_encoder2': False}
[2024-11-25 20:04:43][root][INFO] - fsdp_config: {'mixed_precision': True, 'use_fp16': False, 'sharding_strategy': 'NO_SHARD', 'checkpoint_type': 'SHARDED_STATE_DICT', 'fsdp_activation_checkpointing': True, 'fsdp_cpu_offload': False, 'pure_bf16': False, 'optimizer': 'AdamW'}
[2024-11-25 20:04:43][root][INFO] - model_config: {'file': 'examples/asr_librispeech/model/slam_model_asr.py:model_factory', 'llm_name': 'llama32_1b', 'llm_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', 'llm_type': 'decoder_only', 'llm_dim': 2048, 'encoder_name': 'wavlm', 'encoder_ds_rate': 2, 'encoder_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/WavLM-Large.pt', 'encoder_dim': 1024, 'encoder_projector': 'dual', 'encoder_projector_ds_rate': 5, 'modal': 'audio', 'normalize': True, 'encoder_type': 'finetune', 'encoder2_name': 'w2v2', 'encoder2_dim': 1024, 'encoder2_path': 'vitouphy/wav2vec2-xls-r-300m-timit-phoneme'}
[2024-11-25 20:04:45][slam_llm.models.wavlm.WavLM][INFO] - WavLM Config: {'extractor_mode': 'layer_norm', 'encoder_layers': 24, 'encoder_embed_dim': 1024, 'encoder_ffn_embed_dim': 4096, 'encoder_attention_heads': 16, 'activation_fn': 'gelu', 'layer_norm_first': True, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'feature_grad_mult': 1.0, 'normalize': True, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.0, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.0, 'mask_length': 10, 'mask_prob': 0.8, 'mask_selection': 'static', 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 10, 'mask_channel_prob': 0.0, 'mask_channel_selection': 'static', 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'relative_position_embedding': True, 'num_buckets': 320, 'max_distance': 800, 'gru_rel_pos': True}
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:28: UserWarning: torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.
  warnings.warn("torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.")
[2024-11-25 20:04:50][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-25 20:04:50][slam_llm.utils.train_utils][INFO] - --> wavlm has 315.45312 Million params

[2024-11-25 20:04:50][slam_llm.utils.train_utils][INFO] - --> Module wavlm
[2024-11-25 20:04:50][slam_llm.utils.train_utils][INFO] - --> wavlm has 0.0 Million params

[2024-11-25 20:04:53][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-25 20:04:53][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-25 20:04:53][slam_llm.utils.train_utils][INFO] - --> Module w2v2
[2024-11-25 20:04:53][slam_llm.utils.train_utils][INFO] - --> w2v2 has 315.43872 Million params

[2024-11-25 20:04:58][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 20:04:58][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 1235.8144 Million params

[2024-11-25 20:04:58][slam_llm.models.slam_model][INFO] - setup peft...
trainable params: 5,636,096 || all params: 1,241,450,496 || trainable%: 0.4539928106807088
[2024-11-25 20:04:58][slam_llm.utils.train_utils][INFO] - --> Module llama32_1b
[2024-11-25 20:04:58][slam_llm.utils.train_utils][INFO] - --> llama32_1b has 5.636096 Million params

[2024-11-25 20:04:58][slam_llm.utils.train_utils][INFO] - --> Module dual
[2024-11-25 20:04:58][slam_llm.utils.train_utils][INFO] - --> dual has 25.16992 Million params

[2024-11-25 20:04:58][slam_model_asr.py][INFO] - loading other parts from: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft/asr_epoch_4_step_137_loss_0.7482238411903381/model.pt
[2024-11-25 20:04:58][slam_llm.utils.train_utils][INFO] - --> Model asr
[2024-11-25 20:04:58][slam_llm.utils.train_utils][INFO] - --> asr has 346.244736 Million params

[2024-11-25 20:05:02][root][INFO] - dataset_config: {'dataset': 'speech_dataset', 'file': 'src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', 'train_data_path': None, 'val_data_path': '/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst_phoneme/test.jsonl', 'train_split': 'train', 'test_split': 'validation', 'prompt': None, 'data_path': None, 'max_words': None, 'max_mel': None, 'fix_length_audio': -1, 'inference_mode': True, 'input_type': 'raw', 'mel_size': 80, 'normalize': True}
[2024-11-25 20:05:03][root][INFO] - --> Training Set Length = 652
[2024-11-25 20:05:03][root][INFO] - =====================================

  0%|          | 0/163 [00:00<?, ?it/s]/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
[2024-11-25 20:05:04][slam_llm.models.slam_model][INFO] - modality encoder
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.7` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:595: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.92` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(

  1%|          | 1/163 [00:02<05:36,  2.08s/it][2024-11-25 20:05:05][slam_llm.models.slam_model][INFO] - modality encoder

  1%|          | 2/163 [00:02<03:12,  1.20s/it][2024-11-25 20:05:06][slam_llm.models.slam_model][INFO] - modality encoder

  2%|▏         | 3/163 [00:03<02:25,  1.10it/s][2024-11-25 20:05:06][slam_llm.models.slam_model][INFO] - modality encoder

  2%|▏         | 4/163 [00:08<07:25,  2.80s/it][2024-11-25 20:05:12][slam_llm.models.slam_model][INFO] - modality encoder

  3%|▎         | 5/163 [00:14<10:17,  3.91s/it][2024-11-25 20:05:18][slam_llm.models.slam_model][INFO] - modality encoder

  4%|▎         | 6/163 [00:22<13:32,  5.18s/it][2024-11-25 20:05:26][slam_llm.models.slam_model][INFO] - modality encoder

  4%|▍         | 7/163 [00:28<14:21,  5.52s/it][2024-11-25 20:05:32][slam_llm.models.slam_model][INFO] - modality encoder

  5%|▍         | 8/163 [00:29<10:16,  3.98s/it][2024-11-25 20:05:32][slam_llm.models.slam_model][INFO] - modality encoder

  6%|▌         | 9/163 [00:35<11:53,  4.63s/it][2024-11-25 20:05:38][slam_llm.models.slam_model][INFO] - modality encoder

  6%|▌         | 10/163 [00:41<12:55,  5.07s/it][2024-11-25 20:05:44][slam_llm.models.slam_model][INFO] - modality encoder

  7%|▋         | 11/163 [00:47<13:40,  5.40s/it][2024-11-25 20:05:51][slam_llm.models.slam_model][INFO] - modality encoder

  7%|▋         | 12/163 [00:53<14:20,  5.70s/it][2024-11-25 20:05:57][slam_llm.models.slam_model][INFO] - modality encoder

  8%|▊         | 13/163 [01:00<14:49,  5.93s/it][2024-11-25 20:06:03][slam_llm.models.slam_model][INFO] - modality encoder

  9%|▊         | 14/163 [01:06<14:54,  6.00s/it][2024-11-25 20:06:10][slam_llm.models.slam_model][INFO] - modality encoder

  9%|▉         | 15/163 [01:07<10:41,  4.34s/it][2024-11-25 20:06:10][slam_llm.models.slam_model][INFO] - modality encoder

 10%|▉         | 16/163 [01:13<11:47,  4.81s/it][2024-11-25 20:06:16][slam_llm.models.slam_model][INFO] - modality encoder

 10%|█         | 17/163 [01:19<12:42,  5.23s/it][2024-11-25 20:06:22][slam_llm.models.slam_model][INFO] - modality encoder

 11%|█         | 18/163 [01:25<13:06,  5.42s/it][2024-11-25 20:06:28][slam_llm.models.slam_model][INFO] - modality encoder

 12%|█▏        | 19/163 [01:25<09:42,  4.04s/it][2024-11-25 20:06:29][slam_llm.models.slam_model][INFO] - modality encoder

 12%|█▏        | 20/163 [01:26<07:24,  3.11s/it][2024-11-25 20:06:30][slam_llm.models.slam_model][INFO] - modality encoder

 13%|█▎        | 21/163 [01:27<05:31,  2.33s/it][2024-11-25 20:06:30][slam_llm.models.slam_model][INFO] - modality encoder

 13%|█▎        | 22/163 [01:27<04:12,  1.79s/it][2024-11-25 20:06:31][slam_llm.models.slam_model][INFO] - modality encoder

 14%|█▍        | 23/163 [01:28<03:27,  1.48s/it][2024-11-25 20:06:32][slam_llm.models.slam_model][INFO] - modality encoder

 15%|█▍        | 24/163 [01:29<03:00,  1.30s/it][2024-11-25 20:06:32][slam_llm.models.slam_model][INFO] - modality encoder

 15%|█▌        | 25/163 [01:35<06:07,  2.67s/it][2024-11-25 20:06:38][slam_llm.models.slam_model][INFO] - modality encoder

 16%|█▌        | 26/163 [01:36<04:50,  2.12s/it][2024-11-25 20:06:39][slam_llm.models.slam_model][INFO] - modality encoder

 17%|█▋        | 27/163 [01:36<03:47,  1.67s/it][2024-11-25 20:06:40][slam_llm.models.slam_model][INFO] - modality encoder

 17%|█▋        | 28/163 [01:42<06:34,  2.92s/it][2024-11-25 20:06:46][slam_llm.models.slam_model][INFO] - modality encoder

 18%|█▊        | 29/163 [01:43<04:59,  2.23s/it][2024-11-25 20:06:46][slam_llm.models.slam_model][INFO] - modality encoder

 18%|█▊        | 30/163 [01:43<03:48,  1.72s/it][2024-11-25 20:06:47][slam_llm.models.slam_model][INFO] - modality encoder

 19%|█▉        | 31/163 [01:44<03:03,  1.39s/it][2024-11-25 20:06:47][slam_llm.models.slam_model][INFO] - modality encoder

 20%|█▉        | 32/163 [01:45<02:30,  1.15s/it][2024-11-25 20:06:48][slam_llm.models.slam_model][INFO] - modality encoder

 20%|██        | 33/163 [01:45<02:07,  1.02it/s][2024-11-25 20:06:49][slam_llm.models.slam_model][INFO] - modality encoder

 21%|██        | 34/163 [01:46<01:58,  1.08it/s][2024-11-25 20:06:49][slam_llm.models.slam_model][INFO] - modality encoder

 21%|██▏       | 35/163 [01:47<01:55,  1.10it/s][2024-11-25 20:06:50][slam_llm.models.slam_model][INFO] - modality encoder

 22%|██▏       | 36/163 [01:48<01:58,  1.07it/s][2024-11-25 20:06:51][slam_llm.models.slam_model][INFO] - modality encoder

 23%|██▎       | 37/163 [01:48<01:38,  1.27it/s][2024-11-25 20:06:52][slam_llm.models.slam_model][INFO] - modality encoder

 23%|██▎       | 38/163 [01:49<01:32,  1.35it/s][2024-11-25 20:06:52][slam_llm.models.slam_model][INFO] - modality encoder

 24%|██▍       | 39/163 [01:55<04:42,  2.28s/it][2024-11-25 20:06:58][slam_llm.models.slam_model][INFO] - modality encoder

 25%|██▍       | 40/163 [01:56<03:48,  1.86s/it][2024-11-25 20:06:59][slam_llm.models.slam_model][INFO] - modality encoder

 25%|██▌       | 41/163 [01:56<02:59,  1.47s/it][2024-11-25 20:07:00][slam_llm.models.slam_model][INFO] - modality encoder

 26%|██▌       | 42/163 [01:57<02:42,  1.34s/it][2024-11-25 20:07:01][slam_llm.models.slam_model][INFO] - modality encoder

 26%|██▋       | 43/163 [01:58<02:10,  1.08s/it][2024-11-25 20:07:01][slam_llm.models.slam_model][INFO] - modality encoder

 27%|██▋       | 44/163 [01:59<02:01,  1.02s/it][2024-11-25 20:07:02][slam_llm.models.slam_model][INFO] - modality encoder

 28%|██▊       | 45/163 [01:59<01:44,  1.13it/s][2024-11-25 20:07:03][slam_llm.models.slam_model][INFO] - modality encoder

 28%|██▊       | 46/163 [02:00<01:28,  1.32it/s][2024-11-25 20:07:03][slam_llm.models.slam_model][INFO] - modality encoder

 29%|██▉       | 47/163 [02:06<04:52,  2.52s/it][2024-11-25 20:07:10][slam_llm.models.slam_model][INFO] - modality encoder

 29%|██▉       | 48/163 [02:12<06:50,  3.57s/it][2024-11-25 20:07:16][slam_llm.models.slam_model][INFO] - modality encoder

 30%|███       | 49/163 [02:18<08:18,  4.38s/it][2024-11-25 20:07:22][slam_llm.models.slam_model][INFO] - modality encoder

 31%|███       | 50/163 [02:21<06:59,  3.71s/it][2024-11-25 20:07:24][slam_llm.models.slam_model][INFO] - modality encoder

 31%|███▏      | 51/163 [02:21<05:09,  2.77s/it][2024-11-25 20:07:25][slam_llm.models.slam_model][INFO] - modality encoder

 32%|███▏      | 52/163 [02:22<03:53,  2.10s/it][2024-11-25 20:07:25][slam_llm.models.slam_model][INFO] - modality encoder

 33%|███▎      | 53/163 [02:22<03:00,  1.64s/it][2024-11-25 20:07:26][slam_llm.models.slam_model][INFO] - modality encoder

 33%|███▎      | 54/163 [02:28<05:13,  2.87s/it][2024-11-25 20:07:32][slam_llm.models.slam_model][INFO] - modality encoder

 34%|███▎      | 55/163 [02:30<04:23,  2.44s/it][2024-11-25 20:07:33][slam_llm.models.slam_model][INFO] - modality encoder

 34%|███▍      | 56/163 [02:36<06:18,  3.54s/it][2024-11-25 20:07:39][slam_llm.models.slam_model][INFO] - modality encoder

 35%|███▍      | 57/163 [02:37<04:54,  2.78s/it][2024-11-25 20:07:40][slam_llm.models.slam_model][INFO] - modality encoder

 36%|███▌      | 58/163 [02:43<06:46,  3.87s/it][2024-11-25 20:07:47][slam_llm.models.slam_model][INFO] - modality encoder

 36%|███▌      | 59/163 [02:44<05:20,  3.09s/it][2024-11-25 20:07:48][slam_llm.models.slam_model][INFO] - modality encoder

 37%|███▋      | 60/163 [02:45<03:58,  2.32s/it][2024-11-25 20:07:48][slam_llm.models.slam_model][INFO] - modality encoder

 37%|███▋      | 61/163 [02:47<03:38,  2.14s/it][2024-11-25 20:07:50][slam_llm.models.slam_model][INFO] - modality encoder

 38%|███▊      | 62/163 [02:52<05:29,  3.26s/it][2024-11-25 20:07:56][slam_llm.models.slam_model][INFO] - modality encoder

 39%|███▊      | 63/163 [02:58<06:48,  4.08s/it][2024-11-25 20:08:02][slam_llm.models.slam_model][INFO] - modality encoder

 39%|███▉      | 64/163 [03:04<07:39,  4.65s/it][2024-11-25 20:08:08][slam_llm.models.slam_model][INFO] - modality encoder

 40%|███▉      | 65/163 [03:11<08:23,  5.13s/it][2024-11-25 20:08:14][slam_llm.models.slam_model][INFO] - modality encoder

 40%|████      | 66/163 [03:17<08:38,  5.35s/it][2024-11-25 20:08:20][slam_llm.models.slam_model][INFO] - modality encoder

 41%|████      | 67/163 [03:17<06:13,  3.89s/it][2024-11-25 20:08:20][slam_llm.models.slam_model][INFO] - modality encoder

 42%|████▏     | 68/163 [03:18<04:35,  2.90s/it][2024-11-25 20:08:21][slam_llm.models.slam_model][INFO] - modality encoder

 42%|████▏     | 69/163 [03:23<05:55,  3.79s/it][2024-11-25 20:08:27][slam_llm.models.slam_model][INFO] - modality encoder

 43%|████▎     | 70/163 [03:29<06:42,  4.33s/it][2024-11-25 20:08:33][slam_llm.models.slam_model][INFO] - modality encoder

 44%|████▎     | 71/163 [03:30<05:08,  3.35s/it][2024-11-25 20:08:34][slam_llm.models.slam_model][INFO] - modality encoder

 44%|████▍     | 72/163 [03:32<04:27,  2.94s/it][2024-11-25 20:08:36][slam_llm.models.slam_model][INFO] - modality encoder

 45%|████▍     | 73/163 [03:38<05:55,  3.95s/it][2024-11-25 20:08:42][slam_llm.models.slam_model][INFO] - modality encoder

 45%|████▌     | 74/163 [03:39<04:20,  2.93s/it][2024-11-25 20:08:42][slam_llm.models.slam_model][INFO] - modality encoder

 46%|████▌     | 75/163 [03:45<05:34,  3.80s/it][2024-11-25 20:08:48][slam_llm.models.slam_model][INFO] - modality encoder

 47%|████▋     | 76/163 [03:46<04:17,  2.96s/it][2024-11-25 20:08:49][slam_llm.models.slam_model][INFO] - modality encoder

 47%|████▋     | 77/163 [03:52<05:51,  4.09s/it][2024-11-25 20:08:56][slam_llm.models.slam_model][INFO] - modality encoder

 48%|████▊     | 78/163 [03:54<04:44,  3.35s/it][2024-11-25 20:08:58][slam_llm.models.slam_model][INFO] - modality encoder

 48%|████▊     | 79/163 [04:01<06:08,  4.39s/it][2024-11-25 20:09:04][slam_llm.models.slam_model][INFO] - modality encoder

 49%|████▉     | 80/163 [04:07<06:55,  5.00s/it][2024-11-25 20:09:11][slam_llm.models.slam_model][INFO] - modality encoder

 50%|████▉     | 81/163 [04:14<07:32,  5.52s/it][2024-11-25 20:09:18][slam_llm.models.slam_model][INFO] - modality encoder

 50%|█████     | 82/163 [04:15<05:45,  4.26s/it][2024-11-25 20:09:19][slam_llm.models.slam_model][INFO] - modality encoder

 51%|█████     | 83/163 [04:16<04:13,  3.17s/it][2024-11-25 20:09:19][slam_llm.models.slam_model][INFO] - modality encoder

 52%|█████▏    | 84/163 [04:22<05:12,  3.95s/it][2024-11-25 20:09:25][slam_llm.models.slam_model][INFO] - modality encoder

 52%|█████▏    | 85/163 [04:28<05:55,  4.55s/it][2024-11-25 20:09:31][slam_llm.models.slam_model][INFO] - modality encoder

 53%|█████▎    | 86/163 [04:34<06:20,  4.95s/it][2024-11-25 20:09:37][slam_llm.models.slam_model][INFO] - modality encoder

 53%|█████▎    | 87/163 [04:34<04:36,  3.64s/it][2024-11-25 20:09:38][slam_llm.models.slam_model][INFO] - modality encoder

 54%|█████▍    | 88/163 [04:35<03:22,  2.69s/it][2024-11-25 20:09:38][slam_llm.models.slam_model][INFO] - modality encoder

 55%|█████▍    | 89/163 [04:41<04:32,  3.68s/it][2024-11-25 20:09:45][slam_llm.models.slam_model][INFO] - modality encoder

 55%|█████▌    | 90/163 [04:49<06:00,  4.94s/it][2024-11-25 20:09:52][slam_llm.models.slam_model][INFO] - modality encoder

 56%|█████▌    | 91/163 [04:55<06:28,  5.40s/it][2024-11-25 20:09:59][slam_llm.models.slam_model][INFO] - modality encoder

 56%|█████▋    | 92/163 [05:02<06:49,  5.76s/it][2024-11-25 20:10:06][slam_llm.models.slam_model][INFO] - modality encoder

 57%|█████▋    | 93/163 [05:10<07:32,  6.46s/it][2024-11-25 20:10:13][slam_llm.models.slam_model][INFO] - modality encoder

 58%|█████▊    | 94/163 [05:11<05:42,  4.97s/it][2024-11-25 20:10:15][slam_llm.models.slam_model][INFO] - modality encoder

 58%|█████▊    | 95/163 [05:13<04:29,  3.96s/it][2024-11-25 20:10:16][slam_llm.models.slam_model][INFO] - modality encoder

 59%|█████▉    | 96/163 [05:19<05:07,  4.59s/it][2024-11-25 20:10:22][slam_llm.models.slam_model][INFO] - modality encoder

 60%|█████▉    | 97/163 [05:20<03:51,  3.51s/it][2024-11-25 20:10:23][slam_llm.models.slam_model][INFO] - modality encoder

 60%|██████    | 98/163 [05:26<04:40,  4.32s/it][2024-11-25 20:10:30][slam_llm.models.slam_model][INFO] - modality encoder

 61%|██████    | 99/163 [05:33<05:20,  5.01s/it][2024-11-25 20:10:37][slam_llm.models.slam_model][INFO] - modality encoder

 61%|██████▏   | 100/163 [05:40<06:01,  5.73s/it][2024-11-25 20:10:44][slam_llm.models.slam_model][INFO] - modality encoder

 62%|██████▏   | 101/163 [05:41<04:17,  4.16s/it][2024-11-25 20:10:44][slam_llm.models.slam_model][INFO] - modality encoder

 63%|██████▎   | 102/163 [05:41<03:07,  3.07s/it][2024-11-25 20:10:45][slam_llm.models.slam_model][INFO] - modality encoder

 63%|██████▎   | 103/163 [05:42<02:18,  2.30s/it][2024-11-25 20:10:45][slam_llm.models.slam_model][INFO] - modality encoder

 64%|██████▍   | 104/163 [05:42<01:43,  1.76s/it][2024-11-25 20:10:46][slam_llm.models.slam_model][INFO] - modality encoder

 64%|██████▍   | 105/163 [05:43<01:20,  1.39s/it][2024-11-25 20:10:46][slam_llm.models.slam_model][INFO] - modality encoder

 65%|██████▌   | 106/163 [05:44<01:24,  1.48s/it][2024-11-25 20:10:48][slam_llm.models.slam_model][INFO] - modality encoder

 66%|██████▌   | 107/163 [05:45<01:05,  1.17s/it][2024-11-25 20:10:48][slam_llm.models.slam_model][INFO] - modality encoder

 66%|██████▋   | 108/163 [05:45<00:52,  1.04it/s][2024-11-25 20:10:49][slam_llm.models.slam_model][INFO] - modality encoder

 67%|██████▋   | 109/163 [05:46<00:44,  1.20it/s][2024-11-25 20:10:49][slam_llm.models.slam_model][INFO] - modality encoder

 67%|██████▋   | 110/163 [05:46<00:39,  1.34it/s][2024-11-25 20:10:50][slam_llm.models.slam_model][INFO] - modality encoder

 68%|██████▊   | 111/163 [05:47<00:36,  1.41it/s][2024-11-25 20:10:50][slam_llm.models.slam_model][INFO] - modality encoder

 69%|██████▊   | 112/163 [05:53<01:57,  2.31s/it][2024-11-25 20:10:57][slam_llm.models.slam_model][INFO] - modality encoder

 69%|██████▉   | 113/163 [05:59<02:49,  3.39s/it][2024-11-25 20:11:02][slam_llm.models.slam_model][INFO] - modality encoder

 70%|██████▉   | 114/163 [06:05<03:23,  4.16s/it][2024-11-25 20:11:08][slam_llm.models.slam_model][INFO] - modality encoder

 71%|███████   | 115/163 [06:11<03:45,  4.70s/it][2024-11-25 20:11:14][slam_llm.models.slam_model][INFO] - modality encoder

 71%|███████   | 116/163 [06:17<03:58,  5.08s/it][2024-11-25 20:11:20][slam_llm.models.slam_model][INFO] - modality encoder

 72%|███████▏  | 117/163 [06:18<02:53,  3.77s/it][2024-11-25 20:11:21][slam_llm.models.slam_model][INFO] - modality encoder

 72%|███████▏  | 118/163 [06:18<02:07,  2.84s/it][2024-11-25 20:11:22][slam_llm.models.slam_model][INFO] - modality encoder

 73%|███████▎  | 119/163 [06:19<01:36,  2.18s/it][2024-11-25 20:11:22][slam_llm.models.slam_model][INFO] - modality encoder

 74%|███████▎  | 120/163 [06:19<01:13,  1.72s/it][2024-11-25 20:11:23][slam_llm.models.slam_model][INFO] - modality encoder

 74%|███████▍  | 121/163 [06:20<00:58,  1.39s/it][2024-11-25 20:11:24][slam_llm.models.slam_model][INFO] - modality encoder

 75%|███████▍  | 122/163 [06:26<01:51,  2.72s/it][2024-11-25 20:11:29][slam_llm.models.slam_model][INFO] - modality encoder

 75%|███████▌  | 123/163 [06:27<01:26,  2.17s/it][2024-11-25 20:11:30][slam_llm.models.slam_model][INFO] - modality encoder

 76%|███████▌  | 124/163 [06:33<02:09,  3.32s/it][2024-11-25 20:11:36][slam_llm.models.slam_model][INFO] - modality encoder

 77%|███████▋  | 125/163 [06:39<02:37,  4.15s/it][2024-11-25 20:11:42][slam_llm.models.slam_model][INFO] - modality encoder

 77%|███████▋  | 126/163 [06:45<02:52,  4.65s/it][2024-11-25 20:11:48][slam_llm.models.slam_model][INFO] - modality encoder

 78%|███████▊  | 127/163 [06:45<02:02,  3.41s/it][2024-11-25 20:11:49][slam_llm.models.slam_model][INFO] - modality encoder

 79%|███████▊  | 128/163 [06:46<01:29,  2.55s/it][2024-11-25 20:11:49][slam_llm.models.slam_model][INFO] - modality encoder

 79%|███████▉  | 129/163 [06:52<02:02,  3.61s/it][2024-11-25 20:11:55][slam_llm.models.slam_model][INFO] - modality encoder

 80%|███████▉  | 130/163 [06:53<01:29,  2.72s/it][2024-11-25 20:11:56][slam_llm.models.slam_model][INFO] - modality encoder

 80%|████████  | 131/163 [06:53<01:07,  2.09s/it][2024-11-25 20:11:57][slam_llm.models.slam_model][INFO] - modality encoder

 81%|████████  | 132/163 [06:54<00:52,  1.71s/it][2024-11-25 20:11:57][slam_llm.models.slam_model][INFO] - modality encoder

 82%|████████▏ | 133/163 [06:54<00:40,  1.35s/it][2024-11-25 20:11:58][slam_llm.models.slam_model][INFO] - modality encoder

 82%|████████▏ | 134/163 [06:55<00:31,  1.10s/it][2024-11-25 20:11:59][slam_llm.models.slam_model][INFO] - modality encoder

 83%|████████▎ | 135/163 [06:57<00:34,  1.24s/it][2024-11-25 20:12:00][slam_llm.models.slam_model][INFO] - modality encoder

 83%|████████▎ | 136/163 [07:02<01:10,  2.62s/it][2024-11-25 20:12:06][slam_llm.models.slam_model][INFO] - modality encoder

 84%|████████▍ | 137/163 [07:03<00:54,  2.11s/it][2024-11-25 20:12:07][slam_llm.models.slam_model][INFO] - modality encoder

 85%|████████▍ | 138/163 [07:09<01:20,  3.23s/it][2024-11-25 20:12:13][slam_llm.models.slam_model][INFO] - modality encoder

 85%|████████▌ | 139/163 [07:10<01:03,  2.66s/it][2024-11-25 20:12:14][slam_llm.models.slam_model][INFO] - modality encoder

 86%|████████▌ | 140/163 [07:11<00:46,  2.01s/it][2024-11-25 20:12:14][slam_llm.models.slam_model][INFO] - modality encoder

 87%|████████▋ | 141/163 [07:12<00:35,  1.63s/it][2024-11-25 20:12:15][slam_llm.models.slam_model][INFO] - modality encoder

 87%|████████▋ | 142/163 [07:12<00:27,  1.31s/it][2024-11-25 20:12:16][slam_llm.models.slam_model][INFO] - modality encoder

 88%|████████▊ | 143/163 [07:18<00:53,  2.68s/it][2024-11-25 20:12:22][slam_llm.models.slam_model][INFO] - modality encoder

 88%|████████▊ | 144/163 [07:19<00:39,  2.07s/it][2024-11-25 20:12:22][slam_llm.models.slam_model][INFO] - modality encoder

 89%|████████▉ | 145/163 [07:20<00:29,  1.66s/it][2024-11-25 20:12:23][slam_llm.models.slam_model][INFO] - modality encoder

 90%|████████▉ | 146/163 [07:20<00:24,  1.42s/it][2024-11-25 20:12:24][slam_llm.models.slam_model][INFO] - modality encoder

 90%|█████████ | 147/163 [07:21<00:19,  1.22s/it][2024-11-25 20:12:25][slam_llm.models.slam_model][INFO] - modality encoder

 91%|█████████ | 148/163 [07:22<00:15,  1.01s/it][2024-11-25 20:12:25][slam_llm.models.slam_model][INFO] - modality encoder

 91%|█████████▏| 149/163 [07:23<00:13,  1.01it/s][2024-11-25 20:12:26][slam_llm.models.slam_model][INFO] - modality encoder

 92%|█████████▏| 150/163 [07:23<00:11,  1.09it/s][2024-11-25 20:12:27][slam_llm.models.slam_model][INFO] - modality encoder

 93%|█████████▎| 151/163 [07:29<00:29,  2.43s/it][2024-11-25 20:12:33][slam_llm.models.slam_model][INFO] - modality encoder

 93%|█████████▎| 152/163 [07:35<00:38,  3.53s/it][2024-11-25 20:12:40][slam_llm.models.slam_model][INFO] - modality encoder

 94%|█████████▍| 153/163 [07:44<00:50,  5.01s/it][2024-11-25 20:12:47][slam_llm.models.slam_model][INFO] - modality encoder

 94%|█████████▍| 154/163 [07:50<00:48,  5.34s/it][2024-11-25 20:12:54][slam_llm.models.slam_model][INFO] - modality encoder

 95%|█████████▌| 155/163 [07:57<00:46,  5.76s/it][2024-11-25 20:13:00][slam_llm.models.slam_model][INFO] - modality encoder

 96%|█████████▌| 156/163 [07:57<00:29,  4.20s/it][2024-11-25 20:13:01][slam_llm.models.slam_model][INFO] - modality encoder

 96%|█████████▋| 157/163 [07:58<00:18,  3.07s/it][2024-11-25 20:13:01][slam_llm.models.slam_model][INFO] - modality encoder

 97%|█████████▋| 158/163 [07:58<00:11,  2.31s/it][2024-11-25 20:13:02][slam_llm.models.slam_model][INFO] - modality encoder

 98%|█████████▊| 159/163 [07:59<00:07,  1.88s/it][2024-11-25 20:13:03][slam_llm.models.slam_model][INFO] - modality encoder

 98%|█████████▊| 160/163 [08:00<00:04,  1.67s/it][2024-11-25 20:13:04][slam_llm.models.slam_model][INFO] - modality encoder

 99%|█████████▉| 161/163 [08:01<00:02,  1.34s/it][2024-11-25 20:13:05][slam_llm.models.slam_model][INFO] - modality encoder

 99%|█████████▉| 162/163 [08:09<00:03,  3.26s/it][2024-11-25 20:13:12][slam_llm.models.slam_model][INFO] - modality encoder

100%|██████████| 163/163 [08:10<00:00,  2.63s/it]
100%|██████████| 163/163 [08:10<00:00,  3.01s/it]
Using folder: /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_phoneme_wavlm_llama32_1b_dual_peft
Initial Word Error Rate (WER) before filtering: 2.603969465648855
Number of GT lines after filtering: 629
Number of original PRED lines: 652
Number of filtered repeated lines: 23 out of 652
Lines with repeated words or phrases in PRED file:
- OW P IH N D IH NG D AA G D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D D
- HH IY AH HH IY AH HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY
- AH OW AH EY HH IY Y AE HH IY Y AE HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH I
- HH IY Y AE N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N OW N
- OW K EY HH IY Y AE UW Y AE OW Y AE OW W AAY D AA G W AAY D AA G HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH
- HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE
- V EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B EY B E
- TH R OW W AA N N AE K T D AH D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R D R
- HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE HH AE
- K AH UH K AH UH K AH UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K UH K U
- AE N D EH S AH N IH Z D ER IH NG HH AE D D IY D D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY D IY
- DH AH B AA L IH Z <sil> HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH IY HH
- AH M EY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L
- AH M <sil> D AE N N OW L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L
- AH M AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH AY TH
- SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH SH
- SH S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S
- HH EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L EY L E
- AH M <sil> AE N D G IY S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S S
- SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S SH S
- SH S S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K
- HH IY Z S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K S K
- AH M EY L AE N <sil> D IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L IY L
Filtered Word Error Rate (WER) after removing repeated lines: 2.1554838709677417
