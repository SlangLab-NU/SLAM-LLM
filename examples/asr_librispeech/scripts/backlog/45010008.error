/usr/share/Modules/init/sh: line 2: unalias: salloc: not found
/usr/share/Modules/init/sh: line 2: unalias: df: not found
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:28: UserWarning: torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.
  warnings.warn("torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.")
  0%|          | 0/163 [00:00<?, ?it/s]/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
  1%|          | 1/163 [00:02<07:15,  2.69s/it]  1%|          | 2/163 [00:03<03:28,  1.30s/it]  2%|▏         | 3/163 [00:03<02:14,  1.19it/s]  2%|▏         | 4/163 [00:03<01:42,  1.55it/s]  3%|▎         | 5/163 [00:04<01:27,  1.80it/s]  4%|▎         | 6/163 [00:05<02:28,  1.05it/s]  4%|▍         | 7/163 [00:06<02:13,  1.17it/s]  5%|▍         | 8/163 [00:06<01:45,  1.46it/s]  6%|▌         | 9/163 [00:07<01:38,  1.56it/s]  6%|▌         | 10/163 [00:07<01:32,  1.65it/s]  7%|▋         | 11/163 [00:08<01:29,  1.70it/s]  7%|▋         | 12/163 [00:09<01:37,  1.55it/s]  8%|▊         | 13/163 [00:10<01:47,  1.39it/s]  9%|▊         | 14/163 [00:10<01:37,  1.52it/s]  9%|▉         | 15/163 [00:10<01:20,  1.85it/s] 10%|▉         | 16/163 [00:11<01:12,  2.03it/s] 10%|█         | 17/163 [00:11<01:13,  2.00it/s] 11%|█         | 18/163 [00:12<01:04,  2.25it/s] 12%|█▏        | 19/163 [00:12<00:58,  2.48it/s] 12%|█▏        | 20/163 [00:12<00:58,  2.45it/s] 13%|█▎        | 21/163 [00:13<00:55,  2.56it/s] 13%|█▎        | 22/163 [00:13<00:49,  2.82it/s] 14%|█▍        | 23/163 [00:13<00:47,  2.94it/s] 15%|█▍        | 24/163 [00:14<00:47,  2.91it/s] 15%|█▌        | 25/163 [00:14<00:52,  2.63it/s] 16%|█▌        | 26/163 [00:14<00:50,  2.71it/s] 17%|█▋        | 27/163 [00:15<00:49,  2.74it/s] 17%|█▋        | 28/163 [00:15<00:46,  2.87it/s] 18%|█▊        | 29/163 [00:15<00:45,  2.92it/s] 18%|█▊        | 30/163 [00:16<00:43,  3.09it/s] 19%|█▉        | 31/163 [00:16<00:47,  2.78it/s] 20%|█▉        | 32/163 [00:16<00:49,  2.66it/s] 20%|██        | 33/163 [00:17<00:47,  2.76it/s] 21%|██        | 34/163 [00:17<00:43,  2.94it/s] 21%|██▏       | 35/163 [00:18<00:46,  2.76it/s] 22%|██▏       | 36/163 [00:18<00:49,  2.58it/s] 23%|██▎       | 37/163 [00:18<00:43,  2.88it/s] 23%|██▎       | 38/163 [00:19<00:42,  2.92it/s] 24%|██▍       | 39/163 [00:19<00:48,  2.57it/s] 25%|██▍       | 40/163 [00:19<00:46,  2.66it/s] 25%|██▌       | 41/163 [00:20<00:41,  2.93it/s] 26%|██▌       | 42/163 [00:20<00:53,  2.28it/s] 26%|██▋       | 43/163 [00:21<00:46,  2.58it/s] 27%|██▋       | 44/163 [00:21<00:49,  2.42it/s] 28%|██▊       | 45/163 [00:21<00:48,  2.44it/s] 28%|██▊       | 46/163 [00:22<00:47,  2.44it/s] 29%|██▉       | 47/163 [00:25<02:18,  1.20s/it] 29%|██▉       | 48/163 [00:25<01:54,  1.00it/s] 30%|███       | 49/163 [00:26<01:44,  1.09it/s] 31%|███       | 50/163 [00:27<01:54,  1.01s/it] 31%|███▏      | 51/163 [00:28<01:29,  1.25it/s] 32%|███▏      | 52/163 [00:28<01:12,  1.53it/s] 33%|███▎      | 53/163 [00:28<01:02,  1.76it/s] 33%|███▎      | 54/163 [00:29<00:52,  2.06it/s] 34%|███▎      | 55/163 [00:29<00:53,  2.01it/s] 34%|███▍      | 56/163 [00:30<00:51,  2.06it/s] 35%|███▍      | 57/163 [00:30<00:53,  2.00it/s] 36%|███▌      | 58/163 [00:31<01:03,  1.65it/s] 36%|███▌      | 59/163 [00:32<01:05,  1.59it/s] 37%|███▋      | 60/163 [00:32<00:54,  1.91it/s] 37%|███▋      | 61/163 [00:33<00:59,  1.70it/s] 38%|███▊      | 62/163 [00:33<00:57,  1.77it/s] 39%|███▊      | 63/163 [00:34<01:00,  1.65it/s] 39%|███▉      | 64/163 [00:34<00:57,  1.73it/s] 40%|███▉      | 65/163 [00:35<01:04,  1.51it/s] 40%|████      | 66/163 [00:36<00:57,  1.67it/s] 41%|████      | 67/163 [00:36<00:48,  1.97it/s] 42%|████▏     | 68/163 [00:36<00:41,  2.29it/s] 42%|████▏     | 69/163 [00:37<00:39,  2.36it/s] 43%|████▎     | 70/163 [00:37<00:36,  2.53it/s] 44%|████▎     | 71/163 [00:38<00:39,  2.33it/s] 44%|████▍     | 72/163 [00:39<00:56,  1.60it/s] 45%|████▍     | 73/163 [00:40<01:02,  1.43it/s] 45%|████▌     | 74/163 [00:40<00:52,  1.69it/s] 46%|████▌     | 75/163 [00:40<00:45,  1.93it/s] 47%|████▋     | 76/163 [00:41<00:42,  2.06it/s] 47%|████▋     | 77/163 [00:42<00:56,  1.53it/s] 48%|████▊     | 78/163 [00:43<01:01,  1.37it/s] 48%|████▊     | 79/163 [00:44<01:08,  1.23it/s] 49%|████▉     | 80/163 [00:44<01:05,  1.27it/s] 50%|████▉     | 81/163 [00:45<01:10,  1.17it/s] 50%|█████     | 82/163 [00:46<01:07,  1.20it/s] 51%|█████     | 83/163 [00:46<00:53,  1.50it/s] 52%|█████▏    | 84/163 [00:47<00:43,  1.81it/s] 52%|█████▏    | 85/163 [00:47<00:41,  1.90it/s] 53%|█████▎    | 86/163 [00:47<00:36,  2.13it/s] 53%|█████▎    | 87/163 [00:48<00:31,  2.42it/s] 54%|█████▍    | 88/163 [00:48<00:28,  2.63it/s] 55%|█████▍    | 89/163 [00:49<00:31,  2.32it/s] 55%|█████▌    | 90/163 [00:50<01:02,  1.17it/s] 56%|█████▌    | 91/163 [00:51<01:03,  1.13it/s] 56%|█████▋    | 92/163 [00:52<01:05,  1.08it/s] 57%|█████▋    | 93/163 [00:54<01:25,  1.23s/it] 58%|█████▊    | 94/163 [00:55<01:14,  1.08s/it] 58%|█████▊    | 95/163 [00:56<01:02,  1.08it/s] 59%|█████▉    | 96/163 [00:56<00:51,  1.30it/s] 60%|█████▉    | 97/163 [00:56<00:41,  1.58it/s] 60%|██████    | 98/163 [00:57<00:39,  1.64it/s] 61%|██████    | 99/163 [00:58<00:45,  1.40it/s] 61%|██████▏   | 100/163 [01:00<01:02,  1.01it/s] 62%|██████▏   | 101/163 [01:00<00:48,  1.29it/s] 63%|██████▎   | 102/163 [01:00<00:40,  1.52it/s] 63%|██████▎   | 103/163 [01:00<00:32,  1.82it/s] 64%|██████▍   | 104/163 [01:01<00:27,  2.16it/s] 64%|██████▍   | 105/163 [01:01<00:23,  2.48it/s] 65%|██████▌   | 106/163 [01:02<00:24,  2.28it/s] 66%|██████▌   | 107/163 [01:02<00:21,  2.61it/s] 66%|██████▋   | 108/163 [01:02<00:20,  2.69it/s] 67%|██████▋   | 109/163 [01:02<00:19,  2.76it/s] 67%|██████▋   | 110/163 [01:03<00:18,  2.93it/s] 68%|██████▊   | 111/163 [01:03<00:17,  2.89it/s] 69%|██████▊   | 112/163 [01:04<00:18,  2.71it/s] 69%|██████▉   | 113/163 [01:04<00:18,  2.75it/s] 70%|██████▉   | 114/163 [01:04<00:18,  2.63it/s] 71%|███████   | 115/163 [01:05<00:18,  2.58it/s] 71%|███████   | 116/163 [01:05<00:19,  2.43it/s] 72%|███████▏  | 117/163 [01:06<00:19,  2.39it/s] 72%|███████▏  | 118/163 [01:06<00:17,  2.54it/s] 73%|███████▎  | 119/163 [01:06<00:16,  2.71it/s] 74%|███████▎  | 120/163 [01:07<00:15,  2.85it/s] 74%|███████▍  | 121/163 [01:07<00:14,  2.96it/s] 75%|███████▍  | 122/163 [01:07<00:13,  2.97it/s] 75%|███████▌  | 123/163 [01:08<00:13,  2.94it/s] 76%|███████▌  | 124/163 [01:08<00:14,  2.72it/s] 77%|███████▋  | 125/163 [01:09<00:16,  2.31it/s] 77%|███████▋  | 126/163 [01:09<00:14,  2.54it/s] 78%|███████▊  | 127/163 [01:09<00:13,  2.74it/s] 79%|███████▊  | 128/163 [01:09<00:11,  2.92it/s] 79%|███████▉  | 129/163 [01:10<00:11,  2.91it/s] 80%|███████▉  | 130/163 [01:10<00:11,  2.96it/s] 80%|████████  | 131/163 [01:10<00:10,  3.17it/s] 81%|████████  | 132/163 [01:11<00:10,  2.92it/s] 82%|████████▏ | 133/163 [01:11<00:10,  2.94it/s] 82%|████████▏ | 134/163 [01:11<00:09,  3.13it/s] 83%|████████▎ | 135/163 [01:12<00:13,  2.11it/s] 83%|████████▎ | 136/163 [01:13<00:11,  2.28it/s] 84%|████████▍ | 137/163 [01:13<00:10,  2.51it/s] 85%|████████▍ | 138/163 [01:13<00:10,  2.28it/s] 85%|████████▌ | 139/163 [01:14<00:10,  2.24it/s] 86%|████████▌ | 140/163 [01:14<00:09,  2.48it/s] 87%|████████▋ | 141/163 [01:15<00:08,  2.61it/s] 87%|████████▋ | 142/163 [01:15<00:07,  2.83it/s] 88%|████████▊ | 143/163 [01:15<00:07,  2.62it/s] 88%|████████▊ | 144/163 [01:16<00:06,  2.77it/s] 89%|████████▉ | 145/163 [01:16<00:06,  2.67it/s] 90%|████████▉ | 146/163 [01:16<00:06,  2.73it/s] 90%|█████████ | 147/163 [01:17<00:06,  2.55it/s] 91%|█████████ | 148/163 [01:17<00:05,  2.77it/s] 91%|█████████▏| 149/163 [01:17<00:04,  2.87it/s] 92%|█████████▏| 150/163 [01:18<00:04,  2.85it/s] 93%|█████████▎| 151/163 [01:18<00:05,  2.39it/s] 93%|█████████▎| 152/163 [01:19<00:05,  2.09it/s] 94%|█████████▍| 153/163 [01:21<00:09,  1.00it/s] 94%|█████████▍| 154/163 [01:22<00:07,  1.21it/s] 95%|█████████▌| 155/163 [01:23<00:07,  1.07it/s] 96%|█████████▌| 156/163 [01:23<00:05,  1.32it/s] 96%|█████████▋| 157/163 [01:23<00:03,  1.61it/s] 97%|█████████▋| 158/163 [01:24<00:02,  1.93it/s] 98%|█████████▊| 159/163 [01:24<00:01,  2.03it/s] 98%|█████████▊| 160/163 [01:25<00:01,  1.89it/s] 99%|█████████▉| 161/163 [01:25<00:00,  2.11it/s] 99%|█████████▉| 162/163 [01:27<00:00,  1.10it/s]100%|██████████| 163/163 [01:28<00:00,  1.25it/s]100%|██████████| 163/163 [01:28<00:00,  1.85it/s]
Traceback (most recent call last):
  File "/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/examples/asr_librispeech/scripts/wer.py", line 111, in <module>
    main(args.folder)
  File "/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/examples/asr_librispeech/scripts/wer.py", line 73, in main
    gt, pred = remove_empty_lines(gt, pred)
UnboundLocalError: local variable 'pred' referenced before assignment
train_eval.sh: line 324: [: ==: unary operator expected
wandb: Currently logged in as: jindaz (jindaz-work). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.18.6 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.17.4
wandb: Run data is saved locally in /work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/log/wandb_log/wandb/run-20241107_054511-nb9limvl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run psst_wavlm_llama32_1b_dual_peft
wandb: ⭐️ View project at https://wandb.ai/jindaz-work/SLAM-LLM
wandb: 🚀 View run at https://wandb.ai/jindaz-work/SLAM-LLM/runs/nb9limvl
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:28: UserWarning: torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.
  warnings.warn("torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.")
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/cuda/memory.py:330: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Training Epoch: 10:  97%|[34m█████████▋[0m| 554/574 [00:00<?, ?it/s]/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
Training Epoch: 10:  97%|[34m█████████▋[0m| 555/574 [00:02<00:49,  2.59s/it]Training Epoch: 10:  97%|[34m█████████▋[0m| 556/574 [00:04<00:43,  2.43s/it]/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
Training Epoch: 10:  97%|[34m█████████▋[0m| 557/574 [00:05<00:25,  1.52s/it]Training Epoch: 10:  97%|[34m█████████▋[0m| 558/574 [00:05<00:17,  1.10s/it]Training Epoch: 10:  97%|[34m█████████▋[0m| 559/574 [00:06<00:12,  1.17it/s]Training Epoch: 10:  98%|[34m█████████▊[0m| 560/574 [00:06<00:09,  1.44it/s]Training Epoch: 10:  98%|[34m█████████▊[0m| 561/574 [00:07<00:08,  1.56it/s]Training Epoch: 10:  98%|[34m█████████▊[0m| 562/574 [00:07<00:06,  1.71it/s]Training Epoch: 10:  98%|[34m█████████▊[0m| 563/574 [00:08<00:05,  1.88it/s]Training Epoch: 10:  98%|[34m█████████▊[0m| 564/574 [00:08<00:05,  1.87it/s]Training Epoch: 10:  98%|[34m█████████▊[0m| 565/574 [00:08<00:04,  1.98it/s]Training Epoch: 10:  99%|[34m█████████▊[0m| 566/574 [00:09<00:03,  2.05it/s]Training Epoch: 10:  99%|[34m█████████▉[0m| 567/574 [00:09<00:03,  2.15it/s]Training Epoch: 10:  99%|[34m█████████▉[0m| 568/574 [00:10<00:02,  2.18it/s]Training Epoch: 10:  99%|[34m█████████▉[0m| 569/574 [00:10<00:02,  2.12it/s]Training Epoch: 10:  99%|[34m█████████▉[0m| 570/574 [00:11<00:01,  2.13it/s]Training Epoch: 10:  99%|[34m█████████▉[0m| 571/574 [00:11<00:01,  2.24it/s]Training Epoch: 10: 100%|[34m█████████▉[0m| 572/574 [00:12<00:00,  2.30it/s]Training Epoch: 10: 100%|[34m█████████▉[0m| 573/574 [00:12<00:00,  2.43it/s]Training Epoch: 10: 100%|[34m██████████[0m| 574/574 [00:12<00:00,  2.40it/s]Training Epoch: 10: 575it [00:13,  2.40it/s]                         Training Epoch: 10: 575it [00:13,  1.55it/s]
Error executing job with overrides: ['++model_config.llm_name=llama32_1b', '++model_config.llm_path=/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/Llama-3.2-1B-Instruct', '++model_config.llm_dim=2048', '++model_config.encoder_name=wavlm', '++model_config.normalize=true', '++dataset_config.normalize=true', '++model_config.encoder_projector_ds_rate=5', '++model_config.encoder_path=/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/models/WavLM-Large.pt', '++model_config.encoder2_name=w2v2', '++model_config.encoder2_path=vitouphy/wav2vec2-xls-r-300m-timit-phoneme', '++model_config.encoder_dim=1024', '++model_config.encoder_projector=dual', '++dataset_config.dataset=speech_dataset', '++dataset_config.train_data_path=/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst/train.jsonl', '++dataset_config.file=src/slam_llm/datasets/speech_dataset.py:get_speech_dataset', '++dataset_config.val_data_path=/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/data/psst/validation.jsonl', '++dataset_config.input_type=raw', '++train_config.model_name=asr', '++train_config.num_epochs=10', '++train_config.freeze_encoder=true', '++train_config.freeze_llm=false', '++train_config.batching_strategy=custom', '++train_config.warmup_steps=1000', '++train_config.total_steps=100000', '++train_config.lr=1e-4', '++train_config.validation_interval=3000', '++train_config.batch_size_training=4', '++train_config.val_batch_size=4', '++train_config.num_workers_dataloader=1', '++train_config.output_dir=/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_wavlm_llama32_1b_dual_peft', '++train_config.use_fp16=true', '++train_config.use_peft=true', '++train_config.resume_epoch=10', '++train_config.resume_step=554', '++log_config.use_wandb=true', '++log_config.wandb_exp_name=psst_wavlm_llama32_1b_dual_peft', '++ckpt_path=/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/out/psst_wavlm_llama32_1b_dual_peft/asr_epoch_10_step_554_loss_1.1136375665664673/model.pt', '++dataset_config.input_type=raw']
Traceback (most recent call last):
  File "/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/examples/asr_librispeech/finetune_asr.py", line 51, in <module>
    main_hydra()
  File "/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/examples/asr_librispeech/finetune_asr.py", line 47, in main_hydra
    train(kwargs)
  File "/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/src/slam_llm/pipeline/finetune.py", line 271, in main
    results = train(
  File "/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/src/slam_llm/utils/train_utils.py", line 365, in train
    avg_eval_prep = sum(val_prep)/len(val_prep)
ZeroDivisionError: division by zero
wandb: - 0.007 MB of 0.007 MB uploadedwandb: \ 0.007 MB of 0.007 MB uploadedwandb: | 0.016 MB of 0.042 MB uploaded (0.008 MB deduped)wandb: / 0.016 MB of 0.042 MB uploaded (0.008 MB deduped)wandb: 
wandb: Run history:
wandb:            train/train_epoch_acc ▁
wandb:           train/train_epoch_loss ▁
wandb:           train/train_perplexity ▁
wandb:                   train_inner/lr ▁▃▆█
wandb: train_inner/train_inner_accuracy ▂▁██
wandb:     train_inner/train_inner_loss █▃▁▁
wandb: 
wandb: Run summary:
wandb:            train/train_epoch_acc 0.03625
wandb:           train/train_epoch_loss 0.00227
wandb:           train/train_perplexity 1.00227
wandb:                   train_inner/lr 0.0
wandb: train_inner/train_inner_accuracy 1.0
wandb:     train_inner/train_inner_loss 0.00561
wandb: 
wandb: 🚀 View run psst_wavlm_llama32_1b_dual_peft at: https://wandb.ai/jindaz-work/SLAM-LLM/runs/nb9limvl
wandb: ⭐️ View project at: https://wandb.ai/jindaz-work/SLAM-LLM
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./log/wandb_log/wandb/run-20241107_054511-nb9limvl/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:28: UserWarning: torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.
  warnings.warn("torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.")
  0%|          | 0/163 [00:00<?, ?it/s]/work/van-speech-nlp/jindaznb/slamenv/lib/python3.10/site-packages/torch/nn/functional.py:5137: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
  1%|          | 1/163 [00:01<04:42,  1.74s/it]  1%|          | 2/163 [00:07<10:58,  4.09s/it]  2%|▏         | 3/163 [00:07<06:17,  2.36s/it]  2%|▏         | 4/163 [00:08<04:07,  1.56s/it]  3%|▎         | 5/163 [00:08<03:00,  1.14s/it]  4%|▎         | 6/163 [00:10<03:27,  1.32s/it]  4%|▍         | 7/163 [00:10<02:52,  1.11s/it]  5%|▍         | 8/163 [00:11<02:12,  1.17it/s]  6%|▌         | 9/163 [00:11<01:55,  1.34it/s]  6%|▌         | 10/163 [00:12<01:43,  1.48it/s]  7%|▋         | 11/163 [00:12<01:38,  1.55it/s]  7%|▋         | 12/163 [00:13<01:45,  1.43it/s]  8%|▊         | 13/163 [00:14<01:51,  1.34it/s]  9%|▊         | 14/163 [00:14<01:40,  1.48it/s]  9%|▉         | 15/163 [00:15<01:22,  1.80it/s] 10%|▉         | 16/163 [00:15<01:16,  1.92it/s] 10%|█         | 17/163 [00:16<01:21,  1.79it/s] 11%|█         | 18/163 [00:16<01:10,  2.05it/s] 12%|█▏        | 19/163 [00:16<01:02,  2.30it/s] 12%|█▏        | 20/163 [00:17<01:02,  2.31it/s] 13%|█▎        | 21/163 [00:17<00:59,  2.38it/s] 13%|█▎        | 22/163 [00:18<00:54,  2.59it/s] 14%|█▍        | 23/163 [00:18<00:52,  2.68it/s] 15%|█▍        | 24/163 [00:18<00:52,  2.65it/s] 15%|█▌        | 25/163 [00:19<00:55,  2.46it/s] 16%|█▌        | 26/163 [00:19<01:00,  2.26it/s] 17%|█▋        | 27/163 [00:20<00:58,  2.32it/s] 17%|█▋        | 28/163 [00:20<00:55,  2.43it/s] 18%|█▊        | 29/163 [00:20<00:53,  2.52it/s] 18%|█▊        | 30/163 [00:21<00:48,  2.75it/s] 19%|█▉        | 31/163 [00:21<00:50,  2.59it/s] 20%|█▉        | 32/163 [00:22<00:51,  2.56it/s] 20%|██        | 33/163 [00:22<00:47,  2.73it/s] 21%|██        | 34/163 [00:22<00:44,  2.90it/s] 21%|██▏       | 35/163 [00:23<00:46,  2.73it/s] 22%|██▏       | 36/163 [00:23<00:48,  2.60it/s] 23%|██▎       | 37/163 [00:23<00:44,  2.82it/s] 23%|██▎       | 38/163 [00:24<00:43,  2.87it/s] 24%|██▍       | 39/163 [00:24<00:49,  2.53it/s] 25%|██▍       | 40/163 [00:25<00:47,  2.57it/s] 25%|██▌       | 41/163 [00:25<00:42,  2.84it/s] 26%|██▌       | 42/163 [00:26<00:56,  2.16it/s] 26%|██▋       | 43/163 [00:26<00:50,  2.37it/s] 27%|██▋       | 44/163 [00:26<00:52,  2.27it/s] 28%|██▊       | 45/163 [00:32<04:05,  2.08s/it] 28%|██▊       | 46/163 [00:33<03:02,  1.56s/it] 29%|██▉       | 47/163 [00:34<02:48,  1.46s/it] 29%|██▉       | 48/163 [00:34<02:16,  1.19s/it] 30%|███       | 49/163 [00:35<01:59,  1.05s/it] 31%|███       | 50/163 [00:36<02:04,  1.10s/it] 31%|███▏      | 51/163 [00:37<01:40,  1.11it/s] 32%|███▏      | 52/163 [00:37<01:20,  1.39it/s] 33%|███▎      | 53/163 [00:43<04:06,  2.24s/it] 33%|███▎      | 54/163 [00:43<03:02,  1.67s/it] 34%|███▎      | 55/163 [00:44<02:23,  1.33s/it] 34%|███▍      | 56/163 [00:44<01:54,  1.07s/it] 35%|███▍      | 57/163 [00:45<02:00,  1.13s/it] 36%|███▌      | 58/163 [00:46<01:53,  1.08s/it] 36%|███▌      | 59/163 [00:47<01:39,  1.05it/s] 37%|███▋      | 60/163 [00:47<01:19,  1.30it/s] 37%|███▋      | 61/163 [00:48<01:18,  1.30it/s] 38%|███▊      | 62/163 [00:49<01:10,  1.43it/s] 39%|███▊      | 63/163 [00:49<01:11,  1.39it/s] 39%|███▉      | 64/163 [00:50<01:05,  1.52it/s] 40%|███▉      | 65/163 [00:51<01:10,  1.39it/s] 40%|████      | 66/163 [00:51<01:02,  1.55it/s] 41%|████      | 67/163 [00:52<00:52,  1.84it/s] 42%|████▏     | 68/163 [00:52<00:44,  2.12it/s] 42%|████▏     | 69/163 [00:52<00:43,  2.18it/s] 43%|████▎     | 70/163 [00:53<00:38,  2.39it/s] 44%|████▎     | 71/163 [00:53<00:40,  2.24it/s] 44%|████▍     | 72/163 [00:54<00:57,  1.57it/s] 45%|████▍     | 73/163 [00:55<01:04,  1.40it/s] 45%|████▌     | 74/163 [00:55<00:52,  1.70it/s] 46%|████▌     | 75/163 [00:56<00:44,  1.97it/s] 47%|████▋     | 76/163 [00:56<00:43,  1.99it/s] 47%|████▋     | 77/163 [00:57<00:57,  1.50it/s] 48%|████▊     | 78/163 [00:58<01:04,  1.31it/s] 48%|████▊     | 79/163 [00:59<01:10,  1.19it/s] 49%|████▉     | 80/163 [01:00<01:07,  1.23it/s] 50%|████▉     | 81/163 [01:01<01:11,  1.14it/s] 50%|█████     | 82/163 [01:02<01:08,  1.19it/s] 51%|█████     | 83/163 [01:02<00:54,  1.46it/s] 52%|█████▏    | 84/163 [01:03<00:47,  1.67it/s] 52%|█████▏    | 85/163 [01:03<00:41,  1.90it/s] 53%|█████▎    | 86/163 [01:09<02:40,  2.08s/it] 53%|█████▎    | 87/163 [01:09<01:57,  1.55s/it] 54%|█████▍    | 88/163 [01:09<01:30,  1.21s/it] 55%|█████▍    | 89/163 [01:10<01:16,  1.03s/it] 55%|█████▌    | 90/163 [01:12<01:32,  1.27s/it] 56%|█████▌    | 91/163 [01:13<01:24,  1.18s/it] 56%|█████▋    | 92/163 [01:14<01:20,  1.13s/it] 57%|█████▋    | 93/163 [01:16<01:36,  1.37s/it] 58%|█████▊    | 94/163 [01:16<01:20,  1.17s/it] 58%|█████▊    | 95/163 [01:17<01:06,  1.02it/s] 59%|█████▉    | 96/163 [01:17<00:54,  1.23it/s] 60%|█████▉    | 97/163 [01:18<00:43,  1.52it/s] 60%|██████    | 98/163 [01:18<00:41,  1.57it/s] 61%|██████    | 99/163 [01:19<00:47,  1.36it/s] 61%|██████▏   | 100/163 [01:21<01:02,  1.01it/s] 62%|██████▏   | 101/163 [01:21<00:48,  1.29it/s] 63%|██████▎   | 102/163 [01:21<00:40,  1.50it/s] 63%|██████▎   | 103/163 [01:22<00:34,  1.75it/s] 64%|██████▍   | 104/163 [01:22<00:28,  2.05it/s] 64%|██████▍   | 105/163 [01:22<00:24,  2.34it/s] 65%|██████▌   | 106/163 [01:28<01:58,  2.07s/it] 66%|██████▌   | 107/163 [01:29<01:25,  1.53s/it] 66%|██████▋   | 108/163 [01:29<01:04,  1.17s/it] 67%|██████▋   | 109/163 [01:35<02:24,  2.67s/it] 67%|██████▋   | 110/163 [01:35<01:43,  1.95s/it] 68%|██████▊   | 111/163 [01:36<01:18,  1.51s/it] 69%|██████▊   | 112/163 [01:36<01:00,  1.18s/it] 69%|██████▉   | 113/163 [01:37<00:46,  1.07it/s] 70%|██████▉   | 114/163 [01:37<00:40,  1.20it/s] 71%|███████   | 115/163 [01:38<00:33,  1.42it/s] 71%|███████   | 116/163 [01:38<00:32,  1.46it/s] 72%|███████▏  | 117/163 [01:39<00:27,  1.68it/s] 72%|███████▏  | 118/163 [01:39<00:23,  1.93it/s] 73%|███████▎  | 119/163 [01:39<00:20,  2.11it/s] 74%|███████▎  | 120/163 [01:40<00:18,  2.35it/s] 74%|███████▍  | 121/163 [01:40<00:16,  2.55it/s] 75%|███████▍  | 122/163 [01:40<00:15,  2.65it/s] 75%|███████▌  | 123/163 [01:41<00:15,  2.65it/s] 76%|███████▌  | 124/163 [01:41<00:15,  2.54it/s] 77%|███████▋  | 125/163 [01:42<00:17,  2.16it/s] 77%|███████▋  | 126/163 [01:42<00:15,  2.42it/s] 78%|███████▊  | 127/163 [01:42<00:14,  2.57it/s] 79%|███████▊  | 128/163 [01:43<00:12,  2.71it/s] 79%|███████▉  | 129/163 [01:43<00:12,  2.81it/s] 80%|███████▉  | 130/163 [01:43<00:11,  2.89it/s] 80%|████████  | 131/163 [01:44<00:11,  2.88it/s] 81%|████████  | 132/163 [01:44<00:11,  2.74it/s] 82%|████████▏ | 133/163 [01:44<00:10,  2.81it/s] 82%|████████▏ | 134/163 [01:45<00:10,  2.81it/s] 83%|████████▎ | 135/163 [01:46<00:14,  1.99it/s] 83%|████████▎ | 136/163 [01:46<00:12,  2.18it/s] 84%|████████▍ | 137/163 [01:46<00:10,  2.43it/s] 85%|████████▍ | 138/163 [01:47<00:10,  2.44it/s] 85%|████████▌ | 139/163 [01:53<00:49,  2.08s/it] 86%|████████▌ | 140/163 [01:53<00:35,  1.55s/it] 87%|████████▋ | 141/163 [01:53<00:26,  1.23s/it] 87%|████████▋ | 142/163 [01:54<00:19,  1.06it/s] 88%|████████▊ | 143/163 [01:54<00:15,  1.25it/s] 88%|████████▊ | 144/163 [01:55<00:12,  1.53it/s] 89%|████████▉ | 145/163 [01:55<00:10,  1.80it/s] 90%|████████▉ | 146/163 [01:55<00:08,  1.99it/s] 90%|█████████ | 147/163 [01:56<00:08,  1.96it/s] 91%|█████████ | 148/163 [01:56<00:06,  2.26it/s] 91%|█████████▏| 149/163 [01:56<00:05,  2.41it/s] 92%|█████████▏| 150/163 [01:57<00:05,  2.47it/s] 93%|█████████▎| 151/163 [01:57<00:05,  2.14it/s] 93%|█████████▎| 152/163 [01:58<00:05,  1.92it/s] 94%|█████████▍| 153/163 [02:00<00:10,  1.02s/it] 94%|█████████▍| 154/163 [02:01<00:07,  1.18it/s] 95%|█████████▌| 155/163 [02:02<00:07,  1.06it/s] 96%|█████████▌| 156/163 [02:02<00:05,  1.25it/s] 96%|█████████▋| 157/163 [02:03<00:04,  1.48it/s] 97%|█████████▋| 158/163 [02:03<00:02,  1.76it/s] 98%|█████████▊| 159/163 [02:03<00:02,  1.90it/s] 98%|█████████▊| 160/163 [02:04<00:01,  1.81it/s] 99%|█████████▉| 161/163 [02:05<00:01,  1.90it/s] 99%|█████████▉| 162/163 [02:06<00:00,  1.05it/s]100%|██████████| 163/163 [02:07<00:00,  1.21it/s]100%|██████████| 163/163 [02:07<00:00,  1.28it/s]
Traceback (most recent call last):
  File "/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/examples/asr_librispeech/scripts/wer.py", line 111, in <module>
    main(args.folder)
  File "/work/van-speech-nlp/jindaznb/jslpnb/mllm_experiments/slam-llm/examples/asr_librispeech/scripts/wer.py", line 73, in main
    gt, pred = remove_empty_lines(gt, pred)
UnboundLocalError: local variable 'pred' referenced before assignment
